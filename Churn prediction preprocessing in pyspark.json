{"paragraphs":[{"text":"%pyspark\n\nspark.conf.set(\"spark.driver.memory\", \"32g\")\nspark.conf.set(\"spark.executor.memory\", \"32g\")\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1595567704452_-129980635","id":"20200722-233817_1034158402","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:317"},{"text":"%pyspark\n\nfrom os.path import abspath\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import Row\nfrom pyspark.ml.feature import VectorAssembler\nfrom pyspark.sql.types import *\nfrom pyspark.sql import functions as F\nimport datetime","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1595567704452_1394733902","id":"20200720-011428_1636084055","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:318"},{"text":"%pyspark\npost_schema = StructType([StructField(\"PostId\", StringType(), True), \n                            StructField(\"PostTypeId\", StringType(), True),\n                            StructField(\"AcceptedAnswerId\", StringType(), True),\n                            StructField(\"CreationDate\", TimestampType(), True),\n                            StructField(\"Score\", DoubleType(), True),\n                            StructField(\"OwnerUserId\", StringType(), True),\n                            StructField(\"AnswerCount\", DoubleType(), True),\n                            StructField(\"CommentCount\", DoubleType(), True),\n                            StructField(\"ParentId\", StringType(), True),\n                            StructField(\"CreationDateOfOwner\", TimestampType(), True),\n                            StructField(\"BodyWordNum\", DoubleType(), True)])\n                            \nuser_schema = StructType([StructField(\"Id\", StringType(), True), \n                            StructField(\"CreationDate\", TimestampType(), True),\n                            StructField(\"isChurn\", BooleanType(), False)])                     ","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1595567704452_935020027","id":"20200720-015638_1631124740","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:319"},{"text":"%pyspark\nPATH = \"file:///input/project/\"\n#posts_dist.csv  users_train_dist.csv  users_val_dist.csv\npost_df = spark.read.format(\"csv\").option(\"header\",\"true\").schema(post_schema).load(PATH + \"posts_dist.csv\")\nuser_train = spark.read.format(\"csv\").option(\"header\",\"true\").schema(user_schema).load(PATH + \"users_train_dist.csv\")\nuser_val = spark.read.format(\"csv\").option(\"header\",\"true\").schema(user_schema).load(PATH + \"users_val_dist.csv\")\nuser_test = spark.read.format(\"csv\").option(\"header\",\"true\").schema(user_schema).load(\"file:///home/ss00/users_test_dist.csv\")","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1595567704452_1320073316","id":"20200720-011534_916582053","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:320"},{"text":"%pyspark\npost_df.printSchema()\nuser_train.printSchema()\nuser_val.printSchema()\nuser_test.printSchema()                        ","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- PostId: string (nullable = true)\n |-- PostTypeId: string (nullable = true)\n |-- AcceptedAnswerId: string (nullable = true)\n |-- CreationDate: timestamp (nullable = true)\n |-- Score: double (nullable = true)\n |-- OwnerUserId: string (nullable = true)\n |-- AnswerCount: double (nullable = true)\n |-- CommentCount: double (nullable = true)\n |-- ParentId: string (nullable = true)\n |-- CreationDateOfOwner: timestamp (nullable = true)\n |-- BodyWordNum: double (nullable = true)\n\nroot\n |-- Id: string (nullable = true)\n |-- CreationDate: timestamp (nullable = true)\n |-- isChurn: boolean (nullable = true)\n\nroot\n |-- Id: string (nullable = true)\n |-- CreationDate: timestamp (nullable = true)\n |-- isChurn: boolean (nullable = true)\n\nroot\n |-- Id: string (nullable = true)\n |-- CreationDate: timestamp (nullable = true)\n |-- isChurn: boolean (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-885727128","id":"20200720-014853_90801889","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:321"},{"text":"%pyspark\nuser_train_df = user_train.withColumn('label', user_train['IsChurn'].cast(IntegerType()))\nuser_train_df = user_train_df.withColumn('data_type', F.lit('train'))\nuser_val_df = user_val.withColumn('label', user_val['IsChurn'].cast(IntegerType()))\nuser_val_df = user_val_df.withColumn('data_type', F.lit('val'))\nuser_test_df = user_test.withColumn('label', user_test['IsChurn'].cast(IntegerType()))\nuser_test_df = user_test_df.withColumn('data_type', F.lit('test'))\n\nuser_train_val_test = user_train_df.union(user_val_df).union(user_test_df)\nuser_train_val_test = user_train_val_test.withColumnRenamed(\"CreationDate\", \"Id_creation_date\")\n\npost_df = post_df.withColumnRenamed(\"OwnerUserId\", \"Id\")\npost_df = post_df.withColumn('AcceptedAnswerId', post_df['AcceptedAnswerId'].cast(IntegerType()))\npost_df = post_df.withColumn('AcceptedAnswerId', post_df['AcceptedAnswerId'].cast(StringType()))\n\npost_df = post_df.withColumn('ParentId', post_df['ParentId'].cast(IntegerType()))\npost_df = post_df.withColumn('ParentId', post_df['ParentId'].cast(StringType()))\npost_df = post_df.withColumnRenamed(\"CreationDate\", \"Post_creation_date\").withColumnRenamed(\"CreationDateOfOwner\", \"Id_creation_date\")\npost_df = post_df.withColumn('diff_post_id_creation', F.datediff(F.col('Post_creation_date'), F.col('Id_creation_date')))\npost_df.show()\n\nuser_train_val_test.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+----------+----------------+--------------------+------+---+-----------+------------+--------+--------------------+-----------+---------------------+\n|PostId|PostTypeId|AcceptedAnswerId|  Post_creation_date| Score| Id|AnswerCount|CommentCount|ParentId|    Id_creation_date|BodyWordNum|diff_post_id_creation|\n+------+----------+----------------+--------------------+------+---+-----------+------------+--------+--------------------+-----------+---------------------+\n|     4|         1|               7|2008-07-31 21:42:...| 630.0|  8|       13.0|         2.0|    null|2008-07-31 21:33:...|       65.0|                    0|\n|     6|         1|              31|2008-07-31 22:08:...| 281.0|  9|        6.0|         0.0|    null|2008-07-31 21:35:...|       93.0|                    0|\n|     9|         1|            1404|2008-07-31 23:40:...|1742.0|  1|       63.0|         5.0|    null|2008-07-31 14:22:...|       16.0|                    0|\n|    11|         1|            1248|2008-07-31 23:55:...|1444.0|  1|       37.0|         3.0|    null|2008-07-31 14:22:...|       23.0|                    0|\n|    13|         1|            null|2008-08-01 00:42:...| 590.0|  9|       24.0|        10.0|    null|2008-07-31 21:35:...|       33.0|                    1|\n|    14|         1|            null|2008-08-01 00:59:...| 399.0| 11|       10.0|         4.0|    null|2008-08-01 00:59:...|       14.0|                    0|\n|    16|         1|           12446|2008-08-01 04:59:...| 128.0|  2|        7.0|         0.0|    null|2008-07-31 14:22:...|      145.0|                    1|\n|    17|         1|              26|2008-08-01 05:09:...| 178.0|  2|        9.0|         3.0|    null|2008-07-31 14:22:...|       10.0|                    1|\n|    19|         1|             531|2008-08-01 05:21:...| 310.0| 13|       23.0|        16.0|    null|2008-08-01 04:18:...|      415.0|                    0|\n|    24|         1|              49|2008-08-01 12:12:...| 163.0| 22|        6.0|         0.0|    null|2008-08-01 12:11:...|       24.0|                    0|\n|    25|         1|         1443907|2008-08-01 12:13:...| 143.0| 23|        9.0|         0.0|    null|2008-08-01 12:11:...|      223.0|                    0|\n|    36|         1|             352|2008-08-01 12:35:...| 137.0| 32|        8.0|         2.0|    null|2008-08-01 12:31:...|      220.0|                    0|\n|    39|         1|              45|2008-08-01 12:43:...|  90.0| 33|        2.0|         0.0|    null|2008-08-01 12:32:...|      139.0|                    0|\n|    42|         1|              77|2008-08-01 12:50:...| 266.0| 37|        8.0|         0.0|    null|2008-08-01 12:44:...|       46.0|                    0|\n|    48|         1|           31910|2008-08-01 13:01:...| 250.0| 40|       23.0|         0.0|    null|2008-08-01 12:48:...|      151.0|                    0|\n|    59|         1|           43110|2008-08-01 13:14:...|  96.0| 45|        7.0|         0.0|    null|2008-08-01 13:04:...|       48.0|                    0|\n|    66|         1|            4521|2008-08-01 13:20:...|  79.0| 17|        4.0|         0.0|    null|2008-08-01 12:02:...|       18.0|                    0|\n|    72|         1|            null|2008-08-01 13:38:...|  41.0| 25|        2.0|         1.0|    null|2008-08-01 12:15:...|       27.0|                    0|\n|    79|         1|           62853|2008-08-01 13:56:...|  44.0| 58|        4.0|         0.0|    null|2008-08-01 13:56:...|      176.0|                    0|\n|    80|         1|             124|2008-08-01 13:57:...|  45.0| 26|        3.0|         0.0|    null|2008-08-01 12:18:...|      188.0|                    0|\n+------+----------+----------------+--------------------+------+---+-----------+------------+--------+--------------------+-----------+---------------------+\nonly showing top 20 rows\n\n+-------+--------------------+-------+-----+---------+\n|     Id|    Id_creation_date|isChurn|label|data_type|\n+-------+--------------------+-------+-----+---------+\n|1083952|2011-12-06 16:52:...|   true|    1|    train|\n| 702666|2011-04-11 17:58:...|   true|    1|    train|\n| 898617|2011-08-17 12:31:...|   true|    1|    train|\n|1136230|2012-01-07 17:56:...|   true|    1|    train|\n|1033359|2011-11-07 07:48:...|   true|    1|    train|\n| 893721|2011-08-14 08:29:...|   true|    1|    train|\n| 458274|2010-09-25 17:20:...|   true|    1|    train|\n| 750443|2011-05-12 11:14:...|   true|    1|    train|\n| 628824|2011-02-22 17:59:...|   true|    1|    train|\n| 653670|2011-03-10 14:01:...|   true|    1|    train|\n|1056415|2011-11-20 13:53:...|   true|    1|    train|\n| 691104|2011-04-04 12:48:...|  false|    0|    train|\n| 527877|2010-12-02 11:20:...|   true|    1|    train|\n|  84181|2009-03-29 05:20:...|   true|    1|    train|\n|1014563|2011-10-26 12:42:...|   true|    1|    train|\n|1172233|2012-01-26 21:07:...|   true|    1|    train|\n| 689468|2011-04-03 03:13:...|   true|    1|    train|\n| 218500|2009-11-25 11:00:...|  false|    0|    train|\n|1116708|2011-12-26 19:49:...|   true|    1|    train|\n| 368614|2010-06-16 19:50:...|   true|    1|    train|\n+-------+--------------------+-------+-----+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-1034322800","id":"20200720-022315_1772026372","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:322"},{"text":"%pyspark\nprint(\"Train user distinct cnt: \", user_train_df.select(\"ID\").distinct().count())\nprint(\"Val user distinct cnt: \", user_val_df.select(\"ID\").distinct().count())\nprint(\"Test user distinct cnt: \", user_test_df.select(\"ID\").distinct().count())\nprint(\"Train & Val user distinct cnt: \", user_train_val_test.select(\"ID\").distinct().count())","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Train user distinct cnt:  414400\nVal user distinct cnt:  138133\nTest user distinct cnt:  138133\nTrain & Val user distinct cnt:  690666\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-304953223","id":"20200720-022512_70814451","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:323"},{"text":"%pyspark\nuser_train_val_test.groupBy('label').count().show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+------+\n|label| count|\n+-----+------+\n|    1|466525|\n|    0|224141|\n+-----+------+\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_841893830","id":"20200720-032811_1892098358","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:324"},{"text":"%pyspark\npost_df.select('Id').distinct().count()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"677278\n"}]},"apps":[],"jobName":"paragraph_1595567704452_2025558878","id":"20200720-034104_699409214","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:325"},{"text":"%md\n\n### Make the total ID column from post_df\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Make the total ID column from post_df</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704452_2021127738","id":"20200720-034126_1582284389","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:326"},{"text":"%pyspark\nresult_1 = post_df.select('Id').distinct()\nprint(\"row_num: \" , result_1.count())\nresult_1.show(5)","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  677278\n+----+\n|  Id|\n+----+\n| 296|\n| 691|\n|1436|\n|1512|\n| 829|\n+----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-651425848","id":"20200720-034140_1695288764","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:327"},{"text":"%md\n\n### Add label from train_val_test_df and drop the null values\n\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Add label from train_val_test_df and drop the null values</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704452_-2043520157","id":"20200720-035503_1667210603","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:328"},{"text":"%pyspark\nresult_1 = result_1.join(user_train_val_test,['Id'], how = 'left').select('Id', 'label', 'data_type')\nresult_1 = result_1.filter(result_1['label'].isNotNull() == True)\nresult_1.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----+---------+\n|     Id|label|data_type|\n+-------+-----+---------+\n|1000795|    0|     test|\n|1001866|    0|     test|\n|1002185|    1|    train|\n|1002442|    1|    train|\n|1002883|    0|    train|\n|1002887|    0|    train|\n|1003202|    0|    train|\n|1003644|    1|    train|\n|1003665|    1|    train|\n|1004266|    1|     test|\n|1004364|    1|    train|\n|1005218|    1|    train|\n|1005943|    1|    train|\n|1006370|    0|     test|\n|1006422|    1|    train|\n| 100704|    0|     test|\n|1007462|    0|     test|\n|1008797|    1|    train|\n|1009129|    1|    train|\n|  10096|    1|    train|\n+-------+-----+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-720431625","id":"20200720-035500_1650657926","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:329"},{"text":"%pyspark\nresult_1.groupBy('data_Type').count().show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+------+\n|data_Type| count|\n+---------+------+\n|    train|340721|\n|     test| 92912|\n|      val| 92871|\n+---------+------+\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-1114104020","id":"20200723-054219_1317724448","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:330"},{"text":"%md\n\n### Question - total number of questions by user\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Question - total number of questions by user</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704452_555572335","id":"20200720-022623_1838604277","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:331"},{"text":"%pyspark\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30) ).groupBy('Id').agg(F.countDistinct(\"PostId\").alias('post_cnt')).orderBy('post_cnt', ascending=False)\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------+\n|    Id|post_cnt|\n+------+--------+\n|143030|     157|\n|496949|     148|\n|325418|     133|\n|221023|     107|\n|247265|      97|\n|179736|      94|\n|202335|      92|\n|104015|      89|\n|194328|      87|\n|234322|      85|\n|240698|      85|\n|496686|      82|\n|241717|      82|\n|924353|      75|\n|591005|      73|\n|524723|      73|\n|542308|      73|\n|209512|      72|\n|565968|      72|\n|460407|      65|\n+------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-1086516553","id":"20200720-032704_1789268278","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:332"},{"text":"%pyspark\nresult_2 = result_1.join(query, ['Id'], how = 'left')\nprint(\"null val cnt: \", result_2.filter(result_2['post_cnt'].isNotNull() == False).count())\nresult_2 = result_2.fillna(0, subset=['post_cnt'])\nprint(\"row_num: \" , result_2.count())\nprint(\"null val cnt: \", result_2.filter(result_2['post_cnt'].isNotNull() == False).count())\nresult_2.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"null val cnt:  191233\nrow_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+\n|     Id|label|data_type|post_cnt|\n+-------+-----+---------+--------+\n|1000795|    0|     test|       1|\n|1001866|    0|     test|       1|\n|1002185|    1|    train|       0|\n|1002442|    1|    train|       0|\n|1002883|    0|    train|       0|\n|1002887|    0|    train|       3|\n|1003202|    0|    train|       1|\n|1003644|    1|    train|       1|\n|1003665|    1|    train|       0|\n|1004266|    1|     test|       0|\n|1004364|    1|    train|       0|\n|1005218|    1|    train|       1|\n|1005943|    1|    train|       1|\n|1006370|    0|     test|       1|\n|1006422|    1|    train|       0|\n| 100704|    0|     test|       1|\n|1007462|    0|     test|       2|\n|1008797|    1|    train|       0|\n|1009129|    1|    train|       1|\n|  10096|    1|    train|       1|\n+-------+-----+---------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_464664976","id":"20200720-033629_1706007179","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:333"},{"text":"%md\n\n### Question - total or avg number of having the answer for the questions\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Question - total or avg number of having the answer for the questions</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704452_1272224342","id":"20200720-034959_2047539939","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:334"},{"text":"%pyspark\nansw_created_dt = post_df.filter(post_df['PostTypeId'] == 2).select('ParentId', 'PostId', 'Post_creation_date').dropDuplicates() \\\n                            .withColumnRenamed(\"Post_creation_date\", \"A_Post_creation_date\") \\\n                            .withColumnRenamed(\"ParentId\", \"A_ParentId\") \\\n                            .withColumnRenamed(\"PostId\", \"A_PostId\")\nansw_created_dt.orderBy('A_ParentId').show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------+--------------------+\n|A_ParentId|A_PostId|A_Post_creation_date|\n+----------+--------+--------------------+\n|  10000005|10000042|2012-04-03 19:28:...|\n|  10000007|10000129|2012-04-03 19:36:...|\n|  10000007|10000110|2012-04-03 19:34:...|\n|  10000008|10000227|2012-04-03 19:44:...|\n|   1000001| 1000030|2009-06-16 07:39:...|\n|   1000001| 1227361|2009-08-04 12:54:...|\n|  10000014|10100686|2012-04-11 06:02:...|\n|  10000019|10000061|2012-04-03 19:30:...|\n|  10000020|10014903|2012-04-04 16:00:...|\n|  10000023|10011577|2012-04-04 12:56:...|\n|  10000024|10103344|2012-04-11 09:33:...|\n|  10000031|10000121|2012-04-03 19:35:...|\n|  10000033|10103895|2012-04-11 10:10:...|\n|  10000033|10001393|2012-04-03 21:06:...|\n|   1000004| 1005014|2009-06-17 03:44:...|\n|  10000045|10000112|2012-04-03 19:34:...|\n|  10000049|10000440|2012-04-03 19:59:...|\n|  10000064|10010104|2012-04-04 11:23:...|\n|  10000069|10000123|2012-04-03 19:35:...|\n|  10000074|10001098|2012-04-03 20:44:...|\n+----------+--------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_152070717","id":"20200720-234916_469787703","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:335"},{"text":"%pyspark\nquestion_created_dt = post_df.filter(post_df['PostTypeId'] == 1)\nquestion_created_dt_merged = question_created_dt.join(answ_created_dt, question_created_dt['PostId'] == answ_created_dt['A_ParentId'], how = 'inner')\nquestion_created_dt_merged.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+----------+--------+--------------------+\n|  PostId|PostTypeId|AcceptedAnswerId|  Post_creation_date|Score|     Id|AnswerCount|CommentCount|ParentId|    Id_creation_date|BodyWordNum|diff_post_id_creation|A_ParentId|A_PostId|A_Post_creation_date|\n+--------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+----------+--------+--------------------+\n|10000528|         1|        10000551|2012-04-03 20:04:...|  0.0| 465546|        1.0|         1.0|    null|2010-10-04 05:32:...|       97.0|                  547|  10000528|10000551|2012-04-03 20:06:...|\n|10000670|         1|            null|2012-04-03 20:13:...| -1.0| 838813|        1.0|         1.0|    null|2011-07-11 11:53:...|      101.0|                  267|  10000670|10001199|2012-04-03 20:52:...|\n|10000723|         1|        10001238|2012-04-03 20:17:...|  5.0| 254530|        3.0|         0.0|    null|2010-01-20 01:44:...|       79.0|                  804|  10000723|10000847|2012-04-03 20:25:...|\n|10000761|         1|        10000851|2012-04-03 20:19:...|  2.0|1311308|        2.0|         0.0|    null|2012-04-03 19:54:...|       31.0|                    0|  10000761|10000855|2012-04-03 20:26:...|\n|10003840|         1|            null|2012-04-04 01:32:...|  0.0|1152776|        1.0|         0.0|    null|2012-01-16 22:13:...|      377.0|                   79|  10003840|10033905|2012-04-05 18:24:...|\n|10005243|         1|            null|2012-04-04 05:07:...|  0.0| 942391|        1.0|         0.0|    null|2011-09-13 11:16:...|      109.0|                  204|  10005243|10005552|2012-04-04 05:45:...|\n|10005898|         1|            null|2012-04-04 06:22:...|  1.0|1312014|        3.0|         1.0|    null|2012-04-04 05:42:...|      179.0|                    0|  10005898|10872113|2012-06-03 16:43:...|\n|10005992|         1|            null|2012-04-04 06:31:...|  1.0|1270630|        1.0|         0.0|    null|2012-03-15 03:38:...|       28.0|                   20|  10005992|10006381|2012-04-04 07:04:...|\n|10007113|         1|        10007569|2012-04-04 08:01:...|  2.0|1141493|        1.0|         0.0|    null|2012-01-10 18:02:...|       88.0|                   85|  10007113|10007569|2012-04-04 08:35:...|\n|10007488|         1|        10007604|2012-04-04 08:29:...|  0.0|1013540|        2.0|         0.0|    null|2011-10-25 20:55:...|       60.0|                  162|  10007488|10007604|2012-04-04 08:37:...|\n|10008866|         1|        10009057| 2012-04-04 09:58:18|  2.0|1120617|        4.0|         8.0|    null|2011-12-29 06:53:...|      183.0|                   97|  10008866|10009404|2012-04-04 10:34:...|\n|10008866|         1|        10009057| 2012-04-04 09:58:18|  2.0|1120617|        4.0|         8.0|    null|2011-12-29 06:53:...|      183.0|                   97|  10008866|10009057|2012-04-04 10:09:...|\n|10008866|         1|        10009057| 2012-04-04 09:58:18|  2.0|1120617|        4.0|         8.0|    null|2011-12-29 06:53:...|      183.0|                   97|  10008866|10009025|2012-04-04 10:07:...|\n|10008866|         1|        10009057| 2012-04-04 09:58:18|  2.0|1120617|        4.0|         8.0|    null|2011-12-29 06:53:...|      183.0|                   97|  10008866|10008961|2012-04-04 10:03:...|\n|10009407|         1|            null|2012-04-04 10:34:...|  4.0|1275443|        1.0|         0.0|    null|2012-03-17 07:15:...|       34.0|                   18|  10009407|10009983|2012-04-04 11:15:...|\n|10009792|         1|            null|2012-04-04 11:02:...|  1.0| 755671|        2.0|         0.0|    null|2011-05-16 13:05:...|      121.0|                  324|  10009792|10009916|2012-04-04 11:10:...|\n|10009792|         1|            null|2012-04-04 11:02:...|  1.0| 755671|        2.0|         0.0|    null|2011-05-16 13:05:...|      121.0|                  324|  10009792|10010447|2012-04-04 11:47:...|\n|10010620|         1|        10011774|2012-04-04 11:58:...|  0.0| 465546|        1.0|         8.0|    null|2010-10-04 05:32:...|      156.0|                  548|  10010620|10011774|2012-04-04 13:09:...|\n|10010926|         1|        10011346|2012-04-04 12:17:...|  5.0| 427292|        4.0|         1.0|    null|2010-08-21 20:54:...|      246.0|                  592|  10010926|10011505|2012-04-04 12:52:...|\n|10011000|         1|        10012525|2012-04-04 12:22:...|  0.0|1068513|        1.0|         4.0|    null|2011-11-28 00:40:...|       53.0|                  128|  10011000|10012525|2012-04-04 13:52:...|\n+--------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+----------+--------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_556842101","id":"20200720-235019_676786295","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:336"},{"text":"%pyspark\n\nquestion_created_dt_merged = question_created_dt_merged.withColumn('Aswr_id_created_date_diff', F.datediff(question_created_dt_merged['A_Post_creation_date'], question_created_dt_merged['Id_creation_date']))\nquestion_created_dt_merged.orderBy('PostId').show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+----------+--------+--------------------+-------------------------+\n|  PostId|PostTypeId|AcceptedAnswerId|  Post_creation_date|Score|     Id|AnswerCount|CommentCount|ParentId|    Id_creation_date|BodyWordNum|diff_post_id_creation|A_ParentId|A_PostId|A_Post_creation_date|Aswr_id_created_date_diff|\n+--------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+----------+--------+--------------------+-------------------------+\n|10000007|         1|        10000129|2012-04-03 19:26:...|  1.0|1311218|        2.0|         0.0|    null|2012-04-03 18:59:...|      263.0|                    0|  10000007|10000110|2012-04-03 19:34:...|                        0|\n|10000007|         1|        10000129|2012-04-03 19:26:...|  1.0|1311218|        2.0|         0.0|    null|2012-04-03 18:59:...|      263.0|                    0|  10000007|10000129|2012-04-03 19:36:...|                        0|\n| 1000001|         1|            null|2009-06-16 07:28:...|  0.0| 123536|        3.0|         0.0|    null|2009-06-16 07:26:...|       54.0|                    0|   1000001| 1227361|2009-08-04 12:54:...|                       49|\n| 1000001|         1|            null|2009-06-16 07:28:...|  0.0| 123536|        3.0|         0.0|    null|2009-06-16 07:26:...|       54.0|                    0|   1000001| 1000030|2009-06-16 07:39:...|                        0|\n|10000014|         1|            null|2012-04-03 19:26:...|  2.0| 561731|        1.0|         9.0|    null|2011-01-03 20:37:...|      206.0|                  456|  10000014|10100686|2012-04-11 06:02:...|                      464|\n|10000019|         1|        10000061|2012-04-03 19:26:...|  1.0| 156060|        1.0|         1.0|    null|2009-08-13 19:51:...|       67.0|                  964|  10000019|10000061|2012-04-03 19:30:...|                      964|\n|10000020|         1|        10014903|2012-04-03 19:26:...| 25.0|1227292|        3.0|         3.0|    null|2012-02-23 01:53:...|      141.0|                   40|  10000020|10014903|2012-04-04 16:00:...|                       41|\n|10000023|         1|        10011577|2012-04-03 19:26:...|  0.0| 600873|        1.0|         6.0|    null|2011-02-03 00:45:...|       76.0|                  425|  10000023|10011577|2012-04-04 12:56:...|                      426|\n|10000031|         1|            null|2012-04-03 19:27:...|  3.0|  33080|        1.0|         1.0|    null|2008-10-31 13:18:...|       88.0|                 1250|  10000031|10000121|2012-04-03 19:35:...|                     1250|\n|10000033|         1|        10103895|2012-04-03 19:27:...|  0.0| 995926|        2.0|         0.0|    null|2011-10-14 17:54:...|      278.0|                  172|  10000033|10103895|2012-04-11 10:10:...|                      180|\n|10000033|         1|        10103895|2012-04-03 19:27:...|  0.0| 995926|        2.0|         0.0|    null|2011-10-14 17:54:...|      278.0|                  172|  10000033|10001393|2012-04-03 21:06:...|                      172|\n| 1000004|         1|         1005014|2009-06-16 07:30:...|  0.0|  53481|        1.0|         0.0|    null|2009-01-09 19:33:...|      411.0|                  158|   1000004| 1005014|2009-06-17 03:44:...|                      159|\n|10000045|         1|        10000112|2012-04-03 19:28:...|  1.0|1291744|        1.0|         6.0|    null|2012-03-25 20:01:...|       76.0|                    9|  10000045|10000112|2012-04-03 19:34:...|                        9|\n|10000064|         1|            null|2012-04-03 19:30:...|  1.0|1303826|        3.0|         1.0|    null|2012-03-30 17:25:...|       74.0|                    4|  10000064|10010104|2012-04-04 11:23:...|                        5|\n|10000074|         1|        10001098|2012-04-03 19:31:...| 26.0|1386599|        2.0|         6.0|    null|2010-08-31 11:08:...|      134.0|                  581|  10000074|10001098|2012-04-03 20:44:...|                      581|\n|10000074|         1|        10001098|2012-04-03 19:31:...| 26.0|1386599|        2.0|         6.0|    null|2010-08-31 11:08:...|      134.0|                  581|  10000074|10001161|2012-04-03 20:49:...|                      581|\n|10000083|         1|            null|2012-04-03 19:32:...| 70.0|1257069|        7.0|         4.0|    null|2012-03-08 13:05:...|      164.0|                   26|  10000083|10000178|2012-04-03 19:41:...|                       26|\n|10000092|         1|            null|2012-04-03 19:33:...|  2.0| 704430|        2.0|         0.0|    null|2011-04-12 15:47:...|      111.0|                  357|  10000092|10000319|2012-04-03 19:51:...|                      357|\n|10000098|         1|        10000768|2012-04-03 19:34:...|  4.0| 168775|        2.0|         5.0|    null|2009-09-04 20:42:...|       85.0|                  942|  10000098|10003131|2012-04-03 23:55:...|                      942|\n|10000098|         1|        10000768|2012-04-03 19:34:...|  4.0| 168775|        2.0|         5.0|    null|2009-09-04 20:42:...|       85.0|                  942|  10000098|10000768|2012-04-03 20:20:...|                      942|\n+--------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+----------+--------+--------------------+-------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_1423891475","id":"20200721-003834_1015782078","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:337"},{"text":"%pyspark\nquery = question_created_dt_merged.filter((question_created_dt_merged['Aswr_id_created_date_diff'] <= 30) & \n                                            (question_created_dt_merged['diff_post_id_creation'] <= 30)) \\\n                                            .groupBy('Id').agg(F.countDistinct('A_PostId').alias('ttl_answ_cnt_30days'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------------------+\n|     Id|ttl_answ_cnt_30days|\n+-------+-------------------+\n| 794257|                  1|\n|1250430|                  2|\n| 380550|                  4|\n| 376846|                  3|\n|  65927|                  8|\n|1350816|                  1|\n| 659388|                  2|\n| 717514|                  2|\n|1155111|                 10|\n| 405116|                  3|\n| 117362|                  5|\n| 620275|                  2|\n|1472747|                  9|\n|  18333|                 21|\n| 743171|                 20|\n| 768779|                 15|\n| 599105|                  1|\n| 836781|                  9|\n|1347955|                  1|\n| 255542|                  6|\n+-------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_1606812702","id":"20200721-002230_1024054015","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:338"},{"text":"%pyspark\nresult_3 = result_2.join(query, ['Id'], how = 'left')\nresult_3 = result_3.fillna(0, subset=['ttl_answ_cnt_30days'])\nprint(\"row_num: \" , result_3.count())\nprint(\"null val cnt: \", result_3.filter(result_3['ttl_answ_cnt_30days'].isNotNull() == False).count())\nresult_3.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|\n+-------+-----+---------+--------+-------------------+\n|1000795|    0|     test|       1|                  0|\n|1001866|    0|     test|       1|                  1|\n|1002185|    1|    train|       0|                  0|\n|1002442|    1|    train|       0|                  0|\n|1002883|    0|    train|       0|                  0|\n|1002887|    0|    train|       3|                  2|\n|1003202|    0|    train|       1|                  1|\n|1003644|    1|    train|       1|                  1|\n|1003665|    1|    train|       0|                  0|\n|1004266|    1|     test|       0|                  0|\n|1004364|    1|    train|       0|                  0|\n|1005218|    1|    train|       1|                  0|\n|1005943|    1|    train|       1|                  0|\n|1006370|    0|     test|       1|                  1|\n|1006422|    1|    train|       0|                  0|\n| 100704|    0|     test|       1|                  2|\n|1007462|    0|     test|       2|                  2|\n|1008797|    1|    train|       0|                  0|\n|1009129|    1|    train|       1|                  0|\n|  10096|    1|    train|       1|                  1|\n+-------+-----+---------+--------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_1529007423","id":"20200720-042811_2041371815","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:339"},{"text":"%md\n### Question - avg / min / max number of having the answer for the questions ******* 30일동안 받은 게시물 수","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Question - avg / min / max number of having the answer for the questions ******* 30일동안 받은 게시물 수</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704452_-527825202","id":"20200722-092052_1766092583","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:340"},{"text":"%pyspark\nquery = question_created_dt_merged.groupBy(['Id', 'PostId']).agg(F.countDistinct('A_PostId').alias('A_post_cnt')).groupBy(['Id']).agg(F.min('A_post_cnt').alias('min_answ_cnt_30days'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------------------+\n|     Id|min_answ_cnt_30days|\n+-------+-------------------+\n| 926716|                  1|\n|  13442|                  1|\n| 753426|                  1|\n|1266172|                  1|\n|1442473|                  2|\n| 194106|                  1|\n|1201492|                  1|\n|1210237|                  1|\n|1495015|                  1|\n| 211387|                  2|\n|  26112|                  1|\n| 131949|                  1|\n| 293849|                  1|\n|  18333|                  1|\n| 179104|                  1|\n| 243265|                  1|\n|  89771|                  1|\n| 249357|                  3|\n| 257651|                  2|\n| 126611|                  1|\n+-------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-783555157","id":"20200722-083812_839928539","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:341"},{"text":"%pyspark\nresult_4 = result_3.join(query, ['Id'], how = 'left')\nresult_4 = result_4.fillna(0, subset=['min_answ_cnt_30days'])\nprint(\"row_num: \" , result_4.count())\nprint(\"null val cnt: \", result_4.filter(result_4['min_answ_cnt_30days'].isNotNull() == False).count())\nresult_4.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|\n+-------+-----+---------+--------+-------------------+-------------------+\n|1000795|    0|     test|       1|                  0|                  1|\n|1001866|    0|     test|       1|                  1|                  1|\n|1002185|    1|    train|       0|                  0|                  0|\n|1002442|    1|    train|       0|                  0|                  0|\n|1002883|    0|    train|       0|                  0|                  1|\n|1002887|    0|    train|       3|                  2|                  1|\n|1003202|    0|    train|       1|                  1|                  1|\n|1003644|    1|    train|       1|                  1|                  1|\n|1003665|    1|    train|       0|                  0|                  1|\n|1004266|    1|     test|       0|                  0|                  0|\n|1004364|    1|    train|       0|                  0|                  0|\n|1005218|    1|    train|       1|                  0|                  0|\n|1005943|    1|    train|       1|                  0|                  1|\n|1006370|    0|     test|       1|                  1|                  1|\n|1006422|    1|    train|       0|                  0|                  0|\n| 100704|    0|     test|       1|                  2|                  2|\n|1007462|    0|     test|       2|                  2|                  1|\n|1008797|    1|    train|       0|                  0|                  0|\n|1009129|    1|    train|       1|                  0|                  0|\n|  10096|    1|    train|       1|                  1|                  1|\n+-------+-----+---------+--------+-------------------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_120167719","id":"20200722-092448_641429252","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:342"},{"text":"%pyspark\nquery = question_created_dt_merged.groupBy(['Id', 'PostId']).agg(F.countDistinct('A_PostId').alias('A_post_cnt')).groupBy(['Id']).agg(F.max('A_post_cnt').alias('max_answ_cnt_30days'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------------------+\n|     Id|max_answ_cnt_30days|\n+-------+-------------------+\n| 926716|                  1|\n|  13442|                  5|\n| 753426|                  3|\n|1266172|                  1|\n|1442473|                  2|\n| 194106|                  3|\n|1201492|                  5|\n|1210237|                  2|\n|1495015|                  4|\n| 211387|                  3|\n|  26112|                 15|\n| 131949|                  3|\n| 293849|                  3|\n|  18333|                  8|\n| 179104|                  7|\n| 243265|                  1|\n|  89771|                  8|\n| 249357|                  3|\n| 257651|                  2|\n| 126611|                  3|\n+-------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-712256273","id":"20200722-092529_666664262","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:343"},{"text":"%pyspark\nresult_5 = result_4.join(query, ['Id'], how = 'left')\nresult_5 = result_5.fillna(0, subset=['max_answ_cnt_30days'])\nprint(\"row_num: \" , result_5.count())\nprint(\"null val cnt: \", result_5.filter(result_5['max_answ_cnt_30days'].isNotNull() == False).count())\nresult_5.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|\n|1001866|    0|     test|       1|                  1|                  1|                  1|\n|1002185|    1|    train|       0|                  0|                  0|                  0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|\n|1002887|    0|    train|       3|                  2|                  1|                  1|\n|1003202|    0|    train|       1|                  1|                  1|                  3|\n|1003644|    1|    train|       1|                  1|                  1|                  1|\n|1003665|    1|    train|       0|                  0|                  1|                  4|\n|1004266|    1|     test|       0|                  0|                  0|                  0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|\n|1006370|    0|     test|       1|                  1|                  1|                  1|\n|1006422|    1|    train|       0|                  0|                  0|                  0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|\n|1007462|    0|     test|       2|                  2|                  1|                  1|\n|1008797|    1|    train|       0|                  0|                  0|                  0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-373308507","id":"20200722-092447_2108008254","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:344"},{"text":"%pyspark\nquery = result_5.withColumn('avg_answ_cnt_30days', result_5['ttl_answ_cnt_30days'] / result_5['post_cnt']).select('Id', 'avg_answ_cnt_30days')\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------------------+\n|     Id|avg_answ_cnt_30days|\n+-------+-------------------+\n|1000795|                0.0|\n|1001866|                1.0|\n|1002185|               null|\n|1002442|               null|\n|1002883|               null|\n|1002887| 0.6666666666666666|\n|1003202|                1.0|\n|1003644|                1.0|\n|1003665|               null|\n|1004266|               null|\n|1004364|               null|\n|1005218|                0.0|\n|1005943|                0.0|\n|1006370|                1.0|\n|1006422|               null|\n| 100704|                2.0|\n|1007462|                1.0|\n|1008797|               null|\n|1009129|                0.0|\n|  10096|                1.0|\n+-------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_237618717","id":"20200722-092620_1698582060","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:345"},{"text":"%pyspark\nresult_6 = result_5.join(query, ['Id'], how = 'left')\nresult_6 = result_6.fillna(0, subset=['avg_answ_cnt_30days'])\nprint(\"row_num: \" , result_6.count())\nprint(\"null val cnt: \", result_6.filter(result_6['avg_answ_cnt_30days'].isNotNull() == False).count())\nresult_6.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_832669091","id":"20200722-083459_427183211","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:346"},{"text":"%md\n\n### Question - total number of having the accepted answer for the questions \n\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Question - total number of having the accepted answer for the questions</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704452_-1138399950","id":"20200720-043533_1576820715","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:347"},{"text":"%pyspark\nquestion_created_dt_merged_filtered = question_created_dt_merged.filter(question_created_dt_merged['AcceptedAnswerId'] == question_created_dt_merged['A_PostId'])\nquestion_created_dt_merged_filtered.orderBy('PostId').show()\nprint(question_created_dt_merged_filtered.select('PostID').count())\nprint(question_created_dt_merged_filtered.select('PostID').distinct().count())","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+----------+--------+--------------------+-------------------------+\n|  PostId|PostTypeId|AcceptedAnswerId|  Post_creation_date|Score|     Id|AnswerCount|CommentCount|ParentId|    Id_creation_date|BodyWordNum|diff_post_id_creation|A_ParentId|A_PostId|A_Post_creation_date|Aswr_id_created_date_diff|\n+--------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+----------+--------+--------------------+-------------------------+\n|10000007|         1|        10000129|2012-04-03 19:26:...|  1.0|1311218|        2.0|         0.0|    null|2012-04-03 18:59:...|      263.0|                    0|  10000007|10000129|2012-04-03 19:36:...|                        0|\n|10000019|         1|        10000061|2012-04-03 19:26:...|  1.0| 156060|        1.0|         1.0|    null|2009-08-13 19:51:...|       67.0|                  964|  10000019|10000061|2012-04-03 19:30:...|                      964|\n|10000020|         1|        10014903|2012-04-03 19:26:...| 25.0|1227292|        3.0|         3.0|    null|2012-02-23 01:53:...|      141.0|                   40|  10000020|10014903|2012-04-04 16:00:...|                       41|\n|10000023|         1|        10011577|2012-04-03 19:26:...|  0.0| 600873|        1.0|         6.0|    null|2011-02-03 00:45:...|       76.0|                  425|  10000023|10011577|2012-04-04 12:56:...|                      426|\n|10000033|         1|        10103895|2012-04-03 19:27:...|  0.0| 995926|        2.0|         0.0|    null|2011-10-14 17:54:...|      278.0|                  172|  10000033|10103895|2012-04-11 10:10:...|                      180|\n| 1000004|         1|         1005014|2009-06-16 07:30:...|  0.0|  53481|        1.0|         0.0|    null|2009-01-09 19:33:...|      411.0|                  158|   1000004| 1005014|2009-06-17 03:44:...|                      159|\n|10000045|         1|        10000112|2012-04-03 19:28:...|  1.0|1291744|        1.0|         6.0|    null|2012-03-25 20:01:...|       76.0|                    9|  10000045|10000112|2012-04-03 19:34:...|                        9|\n|10000074|         1|        10001098|2012-04-03 19:31:...| 26.0|1386599|        2.0|         6.0|    null|2010-08-31 11:08:...|      134.0|                  581|  10000074|10001098|2012-04-03 20:44:...|                      581|\n|10000098|         1|        10000768|2012-04-03 19:34:...|  4.0| 168775|        2.0|         5.0|    null|2009-09-04 20:42:...|       85.0|                  942|  10000098|10000768|2012-04-03 20:20:...|                      942|\n|10000126|         1|        10000814|2012-04-03 19:35:...|  1.0| 195489|        1.0|         3.0|    null|2009-10-23 17:38:...|      139.0|                  893|  10000126|10000814|2012-04-03 20:23:...|                      893|\n|10000141|         1|        10000488|2012-04-03 19:37:...|  0.0| 140212|        3.0|         5.0|    null|2009-07-17 14:30:...|      194.0|                  991|  10000141|10000488|2012-04-03 20:02:...|                      991|\n|10000152|         1|        10000199|2012-04-03 19:38:...|  4.0|1301857|        1.0|         2.0|    null|2012-03-29 20:50:...|       46.0|                    5|  10000152|10000199|2012-04-03 19:42:...|                        5|\n|10000164|         1|        10176527|2012-04-03 19:39:...|  2.0| 970171|        1.0|         1.0|    null|2011-09-29 00:40:...|       95.0|                  187|  10000164|10176527|2012-04-16 14:55:...|                      200|\n|10000167|         1|        10000212|2012-04-03 19:39:...|  1.0|1279534|        2.0|         1.0|    null|2012-03-19 20:59:...|      115.0|                   15|  10000167|10000212|2012-04-03 19:43:...|                       15|\n|10000176|         1|        10001266|2012-04-03 19:40:...|  0.0| 793116|        1.0|         0.0|    null|2011-06-10 17:04:...|       93.0|                  298|  10000176|10001266|2012-04-03 20:56:...|                      298|\n|10000180|         1|        10000242|2012-04-03 19:41:...|  0.0| 846504|        2.0|         3.0|    null|2011-07-15 13:13:...|      159.0|                  263|  10000180|10000242|2012-04-03 19:45:...|                      263|\n|10000211|         1|        10002325|2012-04-03 19:43:...|  0.0|1198431|        2.0|         0.0|    null|2012-02-08 23:07:...|       60.0|                   55|  10000211|10002325|2012-04-03 22:25:...|                       55|\n|10000226|         1|        10036622|2012-04-03 19:44:...| 13.0|1276881|        5.0|         5.0|    null|2012-03-18 12:36:...|       82.0|                   16|  10000226|10036622|2012-04-05 21:59:...|                       18|\n| 1000023|         1|         1000050|2009-06-16 07:36:...| 28.0|  90165|        3.0|         0.0|    null|2009-04-13 08:53:...|       88.0|                   64|   1000023| 1000050|2009-06-16 07:43:...|                       64|\n|10000231|         1|        10000259|2012-04-03 19:44:...|  2.0|1110437|        2.0|         0.0|    null|2011-12-21 18:39:...|       55.0|                  104|  10000231|10000259|2012-04-03 19:47:...|                      104|\n+--------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+----------+--------+--------------------+-------------------------+\nonly showing top 20 rows\n\n986410\n986410\n"}]},"apps":[],"jobName":"paragraph_1595567704452_1376467353","id":"20200721-010206_1725695991","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:348"},{"text":"%pyspark\nquery = question_created_dt_merged_filtered.filter((question_created_dt_merged_filtered['PostTypeId'] == 1) & \n                                                    (question_created_dt_merged_filtered['AcceptedAnswerId'].isNotNull()) & \n                                                    (question_created_dt_merged_filtered['diff_post_id_creation'] <= 30) & \n                                                    (question_created_dt_merged_filtered['Aswr_id_created_date_diff'] <= 30)).groupBy('Id').count().withColumnRenamed('count', 'accepted_answ_cnt')\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+\n|     Id|accepted_answ_cnt|\n+-------+-----------------+\n|1539097|                1|\n|2279306|                1|\n| 494948|                4|\n|1142513|                3|\n|1209357|                4|\n|1199749|                2|\n|1257988|                4|\n| 402516|                1|\n| 482395|                4|\n| 798001|                4|\n| 602653|                2|\n| 736162|                1|\n| 969392|                1|\n|  89771|                5|\n| 972202|               14|\n|1061941|                2|\n|1018582|               19|\n| 215094|               14|\n| 512334|                1|\n| 639070|                2|\n+-------+-----------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_1694219943","id":"20200720-044409_5951447","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:349"},{"text":"%pyspark\nresult_7 = result_6.join(query, ['Id'], how = 'left')\nresult_7 = result_7.fillna(0, subset=['accepted_answ_cnt'])\nprint(\"row_num: \" , result_7.count())\nprint(\"null val cnt: \", result_7.filter(result_7['accepted_answ_cnt'].isNotNull() == False).count())\nresult_7.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_1370411455","id":"20200720-044408_1428925351","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:350"},{"text":"%md\n\n### Question - avg/min/max/ttl comment cnt\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Question - avg/min/max/ttl comment cnt</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704452_-2018811381","id":"20200720-050503_137764896","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:351"},{"text":"%pyspark\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.avg('CommentCount').alias('avg_comment_cnt'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|     Id|   avg_comment_cnt|\n+-------+------------------+\n|    296|              0.75|\n|    691|               0.0|\n|   1436|0.7142857142857143|\n|   1512|               0.0|\n|    829|               0.0|\n|   1090|0.6666666666666666|\n|   3210|0.6666666666666666|\n|2019426|               0.0|\n|2148773|               0.2|\n|   6613|               0.4|\n|  11563|               0.5|\n|  12529|               0.0|\n|  13282|               1.0|\n|  14157|               4.0|\n|  14204|               2.0|\n|  11078|               0.0|\n|   5645|              0.25|\n|  10096|               1.0|\n|  14838|               0.5|\n|  15555|               0.5|\n+-------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-506482723","id":"20200720-050928_124800366","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:352"},{"text":"%pyspark\nresult_8 = result_7.join(query, ['Id'], how = 'left')\nresult_8 = result_8.fillna(0, subset=['avg_comment_cnt'])\nprint(\"row_num: \" , result_8.count())\nprint(\"null val cnt: \", result_8.filter(result_8['avg_comment_cnt'].isNotNull() == False).count())\nresult_8.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-31404866","id":"20200720-050927_1956788351","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:353"},{"text":"%pyspark\n#total\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.sum('CommentCount').alias('ttl_comment_cnt'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---------------+\n|     Id|ttl_comment_cnt|\n+-------+---------------+\n|    296|            3.0|\n|    691|            0.0|\n|   1436|            5.0|\n|   1512|            0.0|\n|    829|            0.0|\n|   1090|            2.0|\n|   3210|            2.0|\n|2019426|            0.0|\n|2148773|            1.0|\n|   6613|            2.0|\n|  11563|            1.0|\n|  12529|            0.0|\n|  13282|            1.0|\n|  14157|            4.0|\n|  14204|            4.0|\n|  11078|            0.0|\n|   5645|            1.0|\n|  10096|            1.0|\n|  14838|            1.0|\n|  15555|            3.0|\n+-------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_2118090663","id":"20200722-093128_284628740","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:354"},{"text":"%pyspark\nresult_9 = result_8.join(query, ['Id'], how = 'left')\nresult_9 = result_9.fillna(0, subset=['ttl_comment_cnt'])\nprint(\"row_num: \" , result_9.count())\nprint(\"null val cnt: \", result_9.filter(result_9['ttl_comment_cnt'].isNotNull() == False).count())\nresult_9.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-421354402","id":"20200722-093156_2002478725","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:355"},{"text":"%pyspark\n#min\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.min('CommentCount').alias('min_comment_cnt'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---------------+\n|     Id|min_comment_cnt|\n+-------+---------------+\n|    296|            0.0|\n|    691|            0.0|\n|   1436|            0.0|\n|   1512|            0.0|\n|    829|            0.0|\n|   1090|            0.0|\n|   3210|            0.0|\n|2019426|            0.0|\n|2148773|            0.0|\n|   6613|            0.0|\n|  11563|            0.0|\n|  12529|            0.0|\n|  13282|            1.0|\n|  14157|            4.0|\n|  14204|            0.0|\n|  11078|            0.0|\n|   5645|            0.0|\n|  10096|            1.0|\n|  14838|            0.0|\n|  15555|            0.0|\n+-------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_2035406650","id":"20200722-093156_1264547841","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:356"},{"text":"%pyspark\nresult_10 = result_9.join(query, ['Id'], how = 'left')\nresult_10 = result_10.fillna(0, subset=['min_comment_cnt'])\nprint(\"row_num: \" , result_10.count())\nprint(\"null val cnt: \", result_10.filter(result_10['min_comment_cnt'].isNotNull() == False).count())\nresult_10.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_-566642735","id":"20200722-093155_2124233805","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:357"},{"text":"%pyspark\n#max\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.max('CommentCount').alias('max_comment_cnt'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---------------+\n|     Id|max_comment_cnt|\n+-------+---------------+\n|    296|            1.0|\n|    691|            0.0|\n|   1436|            4.0|\n|   1512|            0.0|\n|    829|            0.0|\n|   1090|            2.0|\n|   3210|            2.0|\n|2019426|            0.0|\n|2148773|            1.0|\n|   6613|            2.0|\n|  11563|            1.0|\n|  12529|            0.0|\n|  13282|            1.0|\n|  14157|            4.0|\n|  14204|            4.0|\n|  11078|            0.0|\n|   5645|            1.0|\n|  10096|            1.0|\n|  14838|            1.0|\n|  15555|            3.0|\n+-------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704452_514964042","id":"20200722-093153_528273259","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:358"},{"text":"%pyspark\nresult_11 = result_10.join(query, ['Id'], how = 'left')\nresult_11 = result_11.fillna(0, subset=['max_comment_cnt'])\nprint(\"row_num: \" , result_11.count())\nprint(\"null val cnt: \", result_11.filter(result_11['max_comment_cnt'].isNotNull() == False).count())\nresult_11.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|max_comment_cnt|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|            2.0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|            0.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|            2.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|            1.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-461720619","id":"20200722-093152_733450347","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:359"},{"text":"%md\n\n### Question - avg / max / min / ttl score\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Question - avg / max / min / ttl score</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704453_1581751098","id":"20200720-050513_36690367","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:360"},{"text":"%pyspark\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.avg('Score').alias('q_avg_score'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|     Id|       q_avg_score|\n+-------+------------------+\n|    296|              8.25|\n|    691|               8.0|\n|   1436|11.714285714285714|\n|   1512|               9.5|\n|    829|               0.0|\n|   1090| 307.6666666666667|\n|   3210| 4.666666666666667|\n|2019426|               3.0|\n|2148773|              16.2|\n|   6613|               9.0|\n|  11563|               3.0|\n|  12529|              2.25|\n|  13282|               3.0|\n|  14157|               4.0|\n|  14204|              58.5|\n|  11078|10.666666666666666|\n|   5645|               5.0|\n|  10096|               2.0|\n|  14838|               8.5|\n|  15555|               7.0|\n+-------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-1449787142","id":"20200720-054818_616060364","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:361"},{"text":"%pyspark\nresult_12 = result_11.join(query, ['Id'], how = 'left')\nresult_12 = result_12.fillna(0, subset=['q_avg_score'])\nprint(\"row_num: \" , result_12.count())\nprint(\"null val cnt: \", result_12.filter(result_12['q_avg_score'].isNotNull() == False).count())\nresult_12.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|max_comment_cnt|q_avg_score|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        0.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|            2.0|        1.0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|       10.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|            2.0|        3.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|            1.0|        2.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-618162633","id":"20200720-054820_145169618","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:362"},{"text":"%pyspark\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.max('Score').alias('q_max_score'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------+\n|     Id|q_max_score|\n+-------+-----------+\n|    296|       15.0|\n|    691|        8.0|\n|   1436|       21.0|\n|   1512|       23.0|\n|    829|        0.0|\n|   1090|      901.0|\n|   3210|        9.0|\n|2019426|        3.0|\n|2148773|       29.0|\n|   6613|       16.0|\n|  11563|        6.0|\n|  12529|        4.0|\n|  13282|        3.0|\n|  14157|        4.0|\n|  14204|      113.0|\n|  11078|       15.0|\n|   5645|       10.0|\n|  10096|        2.0|\n|  14838|       12.0|\n|  15555|       26.0|\n+-------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_1750682445","id":"20200722-093646_1535232553","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:363"},{"text":"%pyspark\nresult_13 = result_12.join(query, ['Id'], how = 'left')\nresult_13 = result_13.fillna(0, subset=['q_max_score'])\nprint(\"row_num: \" , result_13.count())\nprint(\"null val cnt: \", result_13.filter(result_13['q_max_score'].isNotNull() == False).count())\nresult_13.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|max_comment_cnt|q_avg_score|q_max_score|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|            2.0|        1.0|        2.0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|       10.0|       10.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|            2.0|        3.0|        3.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        2.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|            1.0|        2.0|        2.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_718776897","id":"20200722-093646_2010948588","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:364"},{"text":"%pyspark\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.min('Score').alias('q_min_score'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------+\n|     Id|q_min_score|\n+-------+-----------+\n|    296|        4.0|\n|    691|        8.0|\n|   1436|        1.0|\n|   1512|        2.0|\n|    829|        0.0|\n|   1090|        8.0|\n|   3210|        1.0|\n|2019426|        3.0|\n|2148773|        0.0|\n|   6613|        1.0|\n|  11563|        0.0|\n|  12529|        0.0|\n|  13282|        3.0|\n|  14157|        4.0|\n|  14204|        4.0|\n|  11078|        7.0|\n|   5645|        1.0|\n|  10096|        2.0|\n|  14838|        5.0|\n|  15555|        0.0|\n+-------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_209027195","id":"20200722-093646_276493095","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:365"},{"text":"%pyspark\nresult_14 = result_13.join(query, ['Id'], how = 'left')\nresult_14 = result_14.fillna(0, subset=['q_min_score'])\nprint(\"row_num: \" , result_14.count())\nprint(\"null val cnt: \", result_14.filter(result_14['q_min_score'].isNotNull() == False).count())\nresult_14.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|max_comment_cnt|q_avg_score|q_max_score|q_min_score|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|            2.0|        1.0|        2.0|        0.0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|       10.0|       10.0|       10.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|            2.0|        3.0|        3.0|        3.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        2.0|        0.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|            1.0|        2.0|        2.0|        2.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-1401961250","id":"20200722-093646_1099243635","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:366"},{"text":"%pyspark\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.sum('Score').alias('q_ttl_score'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------+\n|     Id|q_ttl_score|\n+-------+-----------+\n|    296|       33.0|\n|    691|        8.0|\n|   1436|       82.0|\n|   1512|       38.0|\n|    829|        0.0|\n|   1090|      923.0|\n|   3210|       14.0|\n|2019426|        3.0|\n|2148773|       81.0|\n|   6613|       45.0|\n|  11563|        6.0|\n|  12529|        9.0|\n|  13282|        3.0|\n|  14157|        4.0|\n|  14204|      117.0|\n|  11078|       32.0|\n|   5645|       20.0|\n|  10096|        2.0|\n|  14838|       17.0|\n|  15555|       42.0|\n+-------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_116271219","id":"20200722-093646_2082619963","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:367"},{"text":"%pyspark\nresult_15 = result_14.join(query, ['Id'], how = 'left')\nresult_15 = result_15.fillna(0, subset=['q_ttl_score'])\nprint(\"row_num: \" , result_15.count())\nprint(\"null val cnt: \", result_15.filter(result_15['q_ttl_score'].isNotNull() == False).count())\nresult_15.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|max_comment_cnt|q_avg_score|q_max_score|q_min_score|q_ttl_score|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|            2.0|        1.0|        2.0|        0.0|        3.0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|       10.0|       10.0|       10.0|       10.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|            2.0|        3.0|        3.0|        3.0|        3.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        2.0|        0.0|        2.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|            1.0|        2.0|        2.0|        2.0|        2.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_1355770944","id":"20200722-093645_1554739830","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:368"},{"text":"%md\n\n### Question - avg / max / min / ttl body words in the questions\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Question - avg / max / min / ttl body words in the questions</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704453_-429667691","id":"20200722-093645_1157734369","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:369"},{"text":"%pyspark\n#avg\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.avg('BodyWordNum').alias('q_avg_bdword'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|     Id|      q_avg_bdword|\n+-------+------------------+\n|    296|              48.0|\n|    691|             142.0|\n|   1436|148.28571428571428|\n|   1512|            116.75|\n|    829|              53.0|\n|   1090|              92.0|\n|   3210|              67.0|\n|2019426|              56.0|\n|2148773|              98.2|\n|   6613|              40.8|\n|  11563|              89.5|\n|  12529|              83.5|\n|  13282|             154.0|\n|  14157|              89.0|\n|  14204|              78.0|\n|  11078|59.666666666666664|\n|   5645|             267.5|\n|  10096|              57.0|\n|  14838|             172.5|\n|  15555|43.333333333333336|\n+-------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-1156825638","id":"20200722-093645_907164739","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:370"},{"text":"%pyspark\nresult_16 = result_15.join(query, ['Id'], how = 'left')\nresult_16 = result_16.fillna(0, subset=['q_avg_bdword'])\nprint(\"row_num: \" , result_16.count())\nprint(\"null val cnt: \", result_16.filter(result_16['q_avg_bdword'].isNotNull() == False).count())\nresult_16.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|max_comment_cnt|q_avg_score|q_max_score|q_min_score|q_ttl_score|     q_avg_bdword|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             30.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|            106.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|            2.0|        1.0|        2.0|        0.0|        3.0|74.66666666666667|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            278.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             54.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|             27.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|       10.0|       10.0|       10.0|       10.0|            166.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            137.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|            2.0|        3.0|        3.0|        3.0|        3.0|            371.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        2.0|        0.0|        2.0|            400.5|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             48.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|            1.0|        2.0|        2.0|        2.0|        2.0|             57.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-326723819","id":"20200722-093645_1750034963","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:371"},{"text":"%pyspark\n#max\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.max('BodyWordNum').alias('q_max_bdword'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------+\n|     Id|q_max_bdword|\n+-------+------------+\n|    296|        78.0|\n|    691|       142.0|\n|   1436|       337.0|\n|   1512|       204.0|\n|    829|        53.0|\n|   1090|       105.0|\n|   3210|       157.0|\n|2019426|        56.0|\n|2148773|       163.0|\n|   6613|        55.0|\n|  11563|       108.0|\n|  12529|       121.0|\n|  13282|       154.0|\n|  14157|        89.0|\n|  14204|        79.0|\n|  11078|        88.0|\n|   5645|       576.0|\n|  10096|        57.0|\n|  14838|       213.0|\n|  15555|        60.0|\n+-------+------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-2129721174","id":"20200722-093645_298963791","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:372"},{"text":"%pyspark\nresult_17 = result_16.join(query, ['Id'], how = 'left')\nresult_17 = result_17.fillna(0, subset=['q_max_bdword'])\nprint(\"row_num: \" , result_17.count())\nprint(\"null val cnt: \", result_17.filter(result_17['q_max_bdword'].isNotNull() == False).count())\nresult_17.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|max_comment_cnt|q_avg_score|q_max_score|q_min_score|q_ttl_score|     q_avg_bdword|q_max_bdword|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             30.0|        30.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|            106.0|       106.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|            2.0|        1.0|        2.0|        0.0|        3.0|74.66666666666667|        87.0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            278.0|       278.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             54.0|        54.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|             27.0|        27.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|       10.0|       10.0|       10.0|       10.0|            166.0|       166.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            137.0|       137.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|            2.0|        3.0|        3.0|        3.0|        3.0|            371.0|       371.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        2.0|        0.0|        2.0|            400.5|       437.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             48.0|        48.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|            1.0|        2.0|        2.0|        2.0|        2.0|             57.0|        57.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-1649758734","id":"20200722-093644_1388950106","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:373"},{"text":"%pyspark\n#min\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.min('BodyWordNum').alias('q_min_bdword'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------+\n|     Id|q_min_bdword|\n+-------+------------+\n|    296|        30.0|\n|    691|       142.0|\n|   1436|        27.0|\n|   1512|        33.0|\n|    829|        53.0|\n|   1090|        82.0|\n|   3210|        11.0|\n|2019426|        56.0|\n|2148773|        57.0|\n|   6613|        33.0|\n|  11563|        71.0|\n|  12529|        49.0|\n|  13282|       154.0|\n|  14157|        89.0|\n|  14204|        77.0|\n|  11078|        40.0|\n|   5645|       132.0|\n|  10096|        57.0|\n|  14838|       132.0|\n|  15555|        28.0|\n+-------+------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_513232956","id":"20200722-094225_827193419","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:374"},{"text":"%pyspark\nresult_18 = result_17.join(query, ['Id'], how = 'left')\nresult_18 = result_18.fillna(0, subset=['q_min_bdword'])\nprint(\"row_num: \" , result_18.count())\nprint(\"null val cnt: \", result_18.filter(result_18['q_min_bdword'].isNotNull() == False).count())\nresult_18.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|max_comment_cnt|q_avg_score|q_max_score|q_min_score|q_ttl_score|     q_avg_bdword|q_max_bdword|q_min_bdword|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             30.0|        30.0|        30.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|            106.0|       106.0|       106.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|            2.0|        1.0|        2.0|        0.0|        3.0|74.66666666666667|        87.0|        60.0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            278.0|       278.0|       278.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             54.0|        54.0|        54.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|             27.0|        27.0|        27.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|       10.0|       10.0|       10.0|       10.0|            166.0|       166.0|       166.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            137.0|       137.0|       137.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|            2.0|        3.0|        3.0|        3.0|        3.0|            371.0|       371.0|       371.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        2.0|        0.0|        2.0|            400.5|       437.0|       364.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             48.0|        48.0|        48.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|            1.0|        2.0|        2.0|        2.0|        2.0|             57.0|        57.0|        57.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_927810800","id":"20200722-094225_1615735916","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:375"},{"text":"%pyspark\n#ttl\nquery = post_df.filter((post_df['PostTypeId'] == 1) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.sum('BodyWordNum').alias('q_ttl_bdword'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------+\n|     Id|q_ttl_bdword|\n+-------+------------+\n|    296|       192.0|\n|    691|       142.0|\n|   1436|      1038.0|\n|   1512|       467.0|\n|    829|        53.0|\n|   1090|       276.0|\n|   3210|       201.0|\n|2019426|        56.0|\n|2148773|       491.0|\n|   6613|       204.0|\n|  11563|       179.0|\n|  12529|       334.0|\n|  13282|       154.0|\n|  14157|        89.0|\n|  14204|       156.0|\n|  11078|       179.0|\n|   5645|      1070.0|\n|  10096|        57.0|\n|  14838|       345.0|\n|  15555|       260.0|\n+-------+------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_1515074699","id":"20200722-094224_559887736","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:376"},{"text":"%pyspark\nresult_19 = result_18.join(query, ['Id'], how = 'left')\nresult_19 = result_19.fillna(0, subset=['q_ttl_bdword'])\nprint(\"row_num: \" , result_19.count())\nprint(\"null val cnt: \", result_19.filter(result_19['q_ttl_bdword'].isNotNull() == False).count())\nresult_19.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|max_comment_cnt|q_avg_score|q_max_score|q_min_score|q_ttl_score|     q_avg_bdword|q_max_bdword|q_min_bdword|q_ttl_bdword|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             30.0|        30.0|        30.0|        30.0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|            106.0|       106.0|       106.0|       106.0|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|            2.0|        1.0|        2.0|        0.0|        3.0|74.66666666666667|        87.0|        60.0|       224.0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            278.0|       278.0|       278.0|       278.0|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             54.0|        54.0|        54.0|        54.0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|             27.0|        27.0|        27.0|        27.0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|       10.0|       10.0|       10.0|       10.0|            166.0|       166.0|       166.0|       166.0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            137.0|       137.0|       137.0|       137.0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|            2.0|        3.0|        3.0|        3.0|        3.0|            371.0|       371.0|       371.0|       371.0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        2.0|        0.0|        2.0|            400.5|       437.0|       364.0|       801.0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             48.0|        48.0|        48.0|        48.0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|            1.0|        2.0|        2.0|        2.0|        2.0|             57.0|        57.0|        57.0|        57.0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_347352165","id":"20200722-094224_147166306","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:377"},{"text":"%md\n\n### Answer - the number of giving answers \n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Answer - the number of giving answers</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704453_-667845010","id":"20200720-060445_771639946","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:378"},{"text":"%pyspark\nquery = post_df.filter((post_df['PostTypeId'] == 2) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.countDistinct('PostID').alias('answ_cnt'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------+\n|    Id|answ_cnt|\n+------+--------+\n|  3210|       5|\n| 18333|      35|\n| 37311|      15|\n| 88311|       2|\n|111982|       8|\n|133918|       1|\n|187951|      10|\n|192839|      13|\n|365079|       7|\n|464050|      86|\n|562183|      82|\n|577042|      36|\n|577511|       3|\n|577541|      24|\n|613997|       6|\n|651856|       1|\n|620275|      16|\n|692770|       8|\n|722232|      57|\n|824472|      78|\n+------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_1961076499","id":"20200720-060501_1933427949","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:379"},{"text":"%pyspark\nresult_20 = result_19.join(query, ['Id'], how = 'left')\nresult_20 = result_20.fillna(0, subset=['answ_cnt'])\nprint(\"row_num: \" , result_20.count())\nprint(\"null val cnt: \", result_20.filter(result_20['answ_cnt'].isNotNull() == False).count())\nresult_20.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+------------+--------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|max_comment_cnt|q_avg_score|q_max_score|q_min_score|q_ttl_score|     q_avg_bdword|q_max_bdword|q_min_bdword|q_ttl_bdword|answ_cnt|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+------------+--------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             30.0|        30.0|        30.0|        30.0|       0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|            106.0|       106.0|       106.0|       106.0|      51|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|            2.0|        1.0|        2.0|        0.0|        3.0|74.66666666666667|        87.0|        60.0|       224.0|       0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            278.0|       278.0|       278.0|       278.0|       1|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             54.0|        54.0|        54.0|        54.0|       0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|             27.0|        27.0|        27.0|        27.0|       0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|       10.0|       10.0|       10.0|       10.0|            166.0|       166.0|       166.0|       166.0|       0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            137.0|       137.0|       137.0|       137.0|       0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|            2.0|        3.0|        3.0|        3.0|        3.0|            371.0|       371.0|       371.0|       371.0|       0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        2.0|        0.0|        2.0|            400.5|       437.0|       364.0|       801.0|       0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             48.0|        48.0|        48.0|        48.0|       0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|            1.0|        2.0|        2.0|        2.0|        2.0|             57.0|        57.0|        57.0|        57.0|       0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+------------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-968723084","id":"20200720-060509_533117037","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:380"},{"text":"%md\n## Feature 9\n### Answer - the number of accepted answers among the giving answers\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Feature 9</h2>\n<h3>Answer - the number of accepted answers among the giving answers</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704453_-1604530065","id":"20200720-062129_536577592","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:381"},{"text":"%pyspark\nquestion_accepted_id = post_df.filter(post_df['PostTypeId'] == 1).select(\"AcceptedAnswerId\").dropDuplicates()\nanswer_for_post_id = post_df.filter((post_df['PostTypeId'] == 2) & (post_df['diff_post_id_creation'] <= 30)).select(\"PostId\", \"Id\").dropDuplicates()\n\naccepted_answer_for_id = question_accepted_id.join(answer_for_post_id, question_accepted_id['AcceptedAnswerId'] == answer_for_post_id[\"PostId\"], how = 'inner') \\\n                                                .groupBy('Id').agg(F.countDistinct(\"PostId\").alias('accepted_answer_cnt_by_qner'))\naccepted_answer_for_id.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---------------------------+\n|     Id|accepted_answer_cnt_by_qner|\n+-------+---------------------------+\n| 325322|                          2|\n| 558517|                         12|\n| 620275|                          1|\n| 810430|                          5|\n| 857631|                          5|\n| 920945|                          3|\n| 971430|                          8|\n|1050146|                          1|\n|1108583|                          1|\n|1420325|                          1|\n| 192264|                         22|\n|1202945|                          1|\n| 128357|                          3|\n|1513794|                          1|\n| 184112|                         17|\n| 736162|                         11|\n| 824472|                         23|\n|1018582|                         13|\n|1330661|                          1|\n| 333648|                          2|\n+-------+---------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_1949358140","id":"20200720-083755_427323307","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:382"},{"text":"%pyspark\nresult_21 = result_20.join(accepted_answer_for_id, ['Id'], how = 'left')\nresult_21 = result_21.fillna(0, subset=['accepted_answer_cnt_by_qner'])\nprint(\"null val cnt: \", result_21.filter(result_21['accepted_answer_cnt_by_qner'].isNotNull() == False).count())\nprint(\"row_num: \" , result_21.count())\nprint(\"null val cnt: \", result_21.filter(result_21['accepted_answer_cnt_by_qner'].isNotNull() == False).count())\nresult_21.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"null val cnt:  0\nrow_num:  526504\nnull val cnt:  0\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+------------+--------+---------------------------+\n|     Id|label|data_type|post_cnt|ttl_answ_cnt_30days|min_answ_cnt_30days|max_answ_cnt_30days|avg_answ_cnt_30days|accepted_answ_cnt|avg_comment_cnt|ttl_comment_cnt|min_comment_cnt|max_comment_cnt|q_avg_score|q_max_score|q_min_score|q_ttl_score|     q_avg_bdword|q_max_bdword|q_min_bdword|q_ttl_bdword|answ_cnt|accepted_answer_cnt_by_qner|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+------------+--------+---------------------------+\n|1000795|    0|     test|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             30.0|        30.0|        30.0|        30.0|       0|                          0|\n|1001866|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|            106.0|       106.0|       106.0|       106.0|      51|                         17|\n|1002185|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|                          0|\n|1002442|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|                          0|\n|1002883|    0|    train|       0|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|                          0|\n|1002887|    0|    train|       3|                  2|                  1|                  1| 0.6666666666666666|                2|            1.0|            3.0|            0.0|            2.0|        1.0|        2.0|        0.0|        3.0|74.66666666666667|        87.0|        60.0|       224.0|       0|                          0|\n|1003202|    0|    train|       1|                  1|                  1|                  3|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            278.0|       278.0|       278.0|       278.0|       1|                          1|\n|1003644|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             54.0|        54.0|        54.0|        54.0|       0|                          0|\n|1003665|    1|    train|       0|                  0|                  1|                  4|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       0|                          0|\n|1004266|    1|     test|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|                          0|\n|1004364|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|                          0|\n|1005218|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|             27.0|        27.0|        27.0|        27.0|       0|                          0|\n|1005943|    1|    train|       1|                  0|                  1|                  1|                0.0|                0|            0.0|            0.0|            0.0|            0.0|       10.0|       10.0|       10.0|       10.0|            166.0|       166.0|       166.0|       166.0|       0|                          0|\n|1006370|    0|     test|       1|                  1|                  1|                  1|                1.0|                1|            0.0|            0.0|            0.0|            0.0|        1.0|        1.0|        1.0|        1.0|            137.0|       137.0|       137.0|       137.0|       0|                          0|\n|1006422|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|                          0|\n| 100704|    0|     test|       1|                  2|                  2|                  2|                2.0|                1|            2.0|            2.0|            2.0|            2.0|        3.0|        3.0|        3.0|        3.0|            371.0|       371.0|       371.0|       371.0|       0|                          0|\n|1007462|    0|     test|       2|                  2|                  1|                  1|                1.0|                0|            0.0|            0.0|            0.0|            0.0|        1.0|        2.0|        0.0|        2.0|            400.5|       437.0|       364.0|       801.0|       0|                          0|\n|1008797|    1|    train|       0|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|              0.0|         0.0|         0.0|         0.0|       1|                          0|\n|1009129|    1|    train|       1|                  0|                  0|                  0|                0.0|                0|            0.0|            0.0|            0.0|            0.0|        0.0|        0.0|        0.0|        0.0|             48.0|        48.0|        48.0|        48.0|       0|                          0|\n|  10096|    1|    train|       1|                  1|                  1|                  1|                1.0|                0|            1.0|            1.0|            1.0|            1.0|        2.0|        2.0|        2.0|        2.0|             57.0|        57.0|        57.0|        57.0|       0|                          0|\n+-------+-----+---------+--------+-------------------+-------------------+-------------------+-------------------+-----------------+---------------+---------------+---------------+---------------+-----------+-----------+-----------+-----------+-----------------+------------+------------+------------+--------+---------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-1042936899","id":"20200720-085408_1139687224","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:383"},{"text":"%pyspark\nresult_21.repartition(1).write.format('csv').mode(\"overwrite\").save(\"file:///home/ss00/churn_prj/data1\",header = 'true')","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1595567704453_835342554","id":"20200723-083730_637215957","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:384"},{"text":"%md\n## Feature 10\n### Answer - avg/ttl/min/max bodyword count in answers \n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Feature 10</h2>\n<h3>Answer - avg/ttl/min/max bodyword count in answers</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704453_-1068374698","id":"20200720-085734_646811207","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:385"},{"text":"%pyspark\nquery = post_df.filter((post_df['PostTypeId'] == 2) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.avg('BodyWordNum').alias('avg_answ_bdword_cnt'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------------------+\n|     Id|avg_answ_bdword_cnt|\n+-------+-------------------+\n|    296|  71.33333333333333|\n|   1436| 115.73333333333333|\n|   1572|              101.5|\n|    829|              120.0|\n|   2069| 152.85714285714286|\n|    691|               21.0|\n|  82208|               98.0|\n|   1090|               57.5|\n|   3210|               80.0|\n|   4821|              184.0|\n|   4937| 174.33333333333334|\n|   5645|             128.96|\n|2148773|  71.92307692307692|\n|   6613|               22.5|\n|   8433|               26.0|\n|  11078|             58.375|\n|  11563|               11.0|\n|  12529|  43.89473684210526|\n|  13442|               74.0|\n|   9030|              192.0|\n+-------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_1595751419","id":"20200720-085735_1519003609","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:386"},{"text":"%pyspark\nresult_22 = result_1.join(query, ['Id'], how = 'left')\nresult_22 = result_22.fillna(0, subset=['avg_answ_bdword_cnt'])\nprint(\"row_num: \" , result_22.count())\nprint(\"null val cnt: \", result_22.filter(result_22['avg_answ_bdword_cnt'].isNotNull() == False).count())\nresult_22.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+-------------------+\n|     Id|label|data_type|avg_answ_bdword_cnt|\n+-------+-----+---------+-------------------+\n|1000795|    0|     test|                0.0|\n|1001866|    0|     test|  64.80392156862744|\n|1002185|    1|    train|               74.0|\n|1002442|    1|    train|               51.0|\n|1002883|    0|    train|               25.0|\n|1002887|    0|    train|                0.0|\n|1003202|    0|    train|               76.0|\n|1003644|    1|    train|                0.0|\n|1003665|    1|    train|                0.0|\n|1004266|    1|     test|               52.0|\n|1004364|    1|    train|                7.0|\n|1005218|    1|    train|                0.0|\n|1005943|    1|    train|                0.0|\n|1006370|    0|     test|                0.0|\n|1006422|    1|    train|               33.0|\n| 100704|    0|     test|                0.0|\n|1007462|    0|     test|                0.0|\n|1008797|    1|    train|              108.0|\n|1009129|    1|    train|                0.0|\n|  10096|    1|    train|                0.0|\n+-------+-----+---------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_1206189707","id":"20200720-085737_605003108","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:387"},{"text":"%pyspark\nquery = post_df.filter((post_df['PostTypeId'] == 2) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.max('BodyWordNum').alias('max_answ_bdword_cnt'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------------------+\n|     Id|max_answ_bdword_cnt|\n+-------+-------------------+\n|    296|              180.0|\n|   1436|              275.0|\n|   1572|              111.0|\n|    829|              120.0|\n|   2069|              483.0|\n|    691|               21.0|\n|  82208|               98.0|\n|   1090|               90.0|\n|   3210|              213.0|\n|   4821|              184.0|\n|   4937|              245.0|\n|   5645|              411.0|\n|2148773|              266.0|\n|   6613|               23.0|\n|   8433|               26.0|\n|  11078|               88.0|\n|  11563|               11.0|\n|  12529|              105.0|\n|  13442|               74.0|\n|   9030|              497.0|\n+-------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-730762800","id":"20200722-094601_223911212","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:388"},{"text":"%pyspark\nresult_23 = result_22.join(query, ['Id'], how = 'left')\nresult_23 = result_23.fillna(0, subset=['max_answ_bdword_cnt'])\nprint(\"row_num: \" , result_23.count())\nprint(\"null val cnt: \", result_23.filter(result_23['max_answ_bdword_cnt'].isNotNull() == False).count())\nresult_23.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+-------------------+-------------------+\n|     Id|label|data_type|avg_answ_bdword_cnt|max_answ_bdword_cnt|\n+-------+-----+---------+-------------------+-------------------+\n|1000795|    0|     test|                0.0|                0.0|\n|1001866|    0|     test|  64.80392156862744|              211.0|\n|1002185|    1|    train|               74.0|               74.0|\n|1002442|    1|    train|               51.0|               51.0|\n|1002883|    0|    train|               25.0|               25.0|\n|1002887|    0|    train|                0.0|                0.0|\n|1003202|    0|    train|               76.0|               76.0|\n|1003644|    1|    train|                0.0|                0.0|\n|1003665|    1|    train|                0.0|                0.0|\n|1004266|    1|     test|               52.0|               52.0|\n|1004364|    1|    train|                7.0|                7.0|\n|1005218|    1|    train|                0.0|                0.0|\n|1005943|    1|    train|                0.0|                0.0|\n|1006370|    0|     test|                0.0|                0.0|\n|1006422|    1|    train|               33.0|               33.0|\n| 100704|    0|     test|                0.0|                0.0|\n|1007462|    0|     test|                0.0|                0.0|\n|1008797|    1|    train|              108.0|              108.0|\n|1009129|    1|    train|                0.0|                0.0|\n|  10096|    1|    train|                0.0|                0.0|\n+-------+-----+---------+-------------------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-1942682990","id":"20200722-094602_879057634","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:389"},{"text":"%pyspark\nquery = post_df.filter((post_df['PostTypeId'] == 2) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.min('BodyWordNum').alias('min_answ_bdword_cnt'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------------------+\n|     Id|min_answ_bdword_cnt|\n+-------+-------------------+\n|    296|               36.0|\n|   1436|               30.0|\n|   1572|               92.0|\n|    829|              120.0|\n|   2069|               53.0|\n|    691|               21.0|\n|  82208|               98.0|\n|   1090|               25.0|\n|   3210|               10.0|\n|   4821|              184.0|\n|   4937|               79.0|\n|   5645|               11.0|\n|2148773|               13.0|\n|   6613|               22.0|\n|   8433|               26.0|\n|  11078|               28.0|\n|  11563|               11.0|\n|  12529|                1.0|\n|  13442|               74.0|\n|   9030|               29.0|\n+-------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_2024230789","id":"20200722-094602_400678024","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:390"},{"text":"%pyspark\nresult_24 = result_23.join(query, ['Id'], how = 'left')\nresult_24 = result_24.fillna(0, subset=['min_answ_bdword_cnt'])\nprint(\"row_num: \" , result_24.count())\n# print(\"null val cnt: \", result_24.filter(result_24['min_answ_bdword_cnt'].isNotNull() == False).count())\nresult_24.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\n+-------+-----+---------+-------------------+-------------------+-------------------+\n|     Id|label|data_type|avg_answ_bdword_cnt|max_answ_bdword_cnt|min_answ_bdword_cnt|\n+-------+-----+---------+-------------------+-------------------+-------------------+\n|1000795|    0|     test|                0.0|                0.0|                0.0|\n|1001866|    0|     test|  64.80392156862744|              211.0|                6.0|\n|1002185|    1|    train|               74.0|               74.0|               74.0|\n|1002442|    1|    train|               51.0|               51.0|               51.0|\n|1002883|    0|    train|               25.0|               25.0|               25.0|\n|1002887|    0|    train|                0.0|                0.0|                0.0|\n|1003202|    0|    train|               76.0|               76.0|               76.0|\n|1003644|    1|    train|                0.0|                0.0|                0.0|\n|1003665|    1|    train|                0.0|                0.0|                0.0|\n|1004266|    1|     test|               52.0|               52.0|               52.0|\n|1004364|    1|    train|                7.0|                7.0|                7.0|\n|1005218|    1|    train|                0.0|                0.0|                0.0|\n|1005943|    1|    train|                0.0|                0.0|                0.0|\n|1006370|    0|     test|                0.0|                0.0|                0.0|\n|1006422|    1|    train|               33.0|               33.0|               33.0|\n| 100704|    0|     test|                0.0|                0.0|                0.0|\n|1007462|    0|     test|                0.0|                0.0|                0.0|\n|1008797|    1|    train|              108.0|              108.0|              108.0|\n|1009129|    1|    train|                0.0|                0.0|                0.0|\n|  10096|    1|    train|                0.0|                0.0|                0.0|\n+-------+-----+---------+-------------------+-------------------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_147544036","id":"20200722-094602_615177401","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:391"},{"text":"%pyspark\nquery = post_df.filter((post_df['PostTypeId'] == 2) & (post_df['diff_post_id_creation'] <= 30)).groupBy('Id').agg(F.sum('BodyWordNum').alias('ttl_answ_bdword_cnt'))\nquery.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------------------+\n|     Id|ttl_answ_bdword_cnt|\n+-------+-------------------+\n|    296|              428.0|\n|   1436|             1736.0|\n|   1572|              203.0|\n|    829|              120.0|\n|   2069|             1070.0|\n|    691|               21.0|\n|  82208|               98.0|\n|   1090|              115.0|\n|   3210|              400.0|\n|   4821|              184.0|\n|   4937|              523.0|\n|   5645|             3224.0|\n|2148773|              935.0|\n|   6613|               45.0|\n|   8433|               26.0|\n|  11078|              467.0|\n|  11563|               11.0|\n|  12529|              834.0|\n|  13442|               74.0|\n|   9030|              768.0|\n+-------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-802381254","id":"20200722-094752_1631300034","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:392"},{"text":"%pyspark\nresult_25 = result_24.join(query, ['Id'], how = 'left')\nresult_25 = result_25.fillna(0, subset=['ttl_answ_bdword_cnt'])\nprint(\"row_num: \" , result_25.count())\n# print(\"null val cnt: \", result_25.filter(result_25['ttl_answ_bdword_cnt'].isNotNull() == False).count())\nresult_25.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+\n|     Id|label|data_type|avg_answ_bdword_cnt|max_answ_bdword_cnt|min_answ_bdword_cnt|ttl_answ_bdword_cnt|\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+\n|1000795|    0|     test|                0.0|                0.0|                0.0|                0.0|\n|1001866|    0|     test|  64.80392156862744|              211.0|                6.0|             3305.0|\n|1002185|    1|    train|               74.0|               74.0|               74.0|               74.0|\n|1002442|    1|    train|               51.0|               51.0|               51.0|               51.0|\n|1002883|    0|    train|               25.0|               25.0|               25.0|               25.0|\n|1002887|    0|    train|                0.0|                0.0|                0.0|                0.0|\n|1003202|    0|    train|               76.0|               76.0|               76.0|               76.0|\n|1003644|    1|    train|                0.0|                0.0|                0.0|                0.0|\n|1003665|    1|    train|                0.0|                0.0|                0.0|                0.0|\n|1004266|    1|     test|               52.0|               52.0|               52.0|               52.0|\n|1004364|    1|    train|                7.0|                7.0|                7.0|                7.0|\n|1005218|    1|    train|                0.0|                0.0|                0.0|                0.0|\n|1005943|    1|    train|                0.0|                0.0|                0.0|                0.0|\n|1006370|    0|     test|                0.0|                0.0|                0.0|                0.0|\n|1006422|    1|    train|               33.0|               33.0|               33.0|               33.0|\n| 100704|    0|     test|                0.0|                0.0|                0.0|                0.0|\n|1007462|    0|     test|                0.0|                0.0|                0.0|                0.0|\n|1008797|    1|    train|              108.0|              108.0|              108.0|              108.0|\n|1009129|    1|    train|                0.0|                0.0|                0.0|                0.0|\n|  10096|    1|    train|                0.0|                0.0|                0.0|                0.0|\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_1219943740","id":"20200722-093803_266346352","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:393"},{"text":"%md\n\n## post and answer creation interval\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>post and answer creation interval</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704453_-1215157491","id":"20200723-040547_1510970266","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:394"},{"text":"%pyspark\nfrom pyspark.sql.window import Window\npost_df_lag = post_df.filter(post_df['diff_post_id_creation'] <= 30) \\\n                        .withColumn('lag_creation_date',F.lag(post_df['Post_creation_date']).over(Window.partitionBy(\"Id\").orderBy(F.col(\"Post_creation_date\").desc())))\npost_df_lag = post_df_lag.withColumn('lag_creation_date_final', F.when(post_df_lag['lag_creation_date'].isNull(), F.date_add(post_df_lag['Id_creation_date'], 30)).otherwise(post_df_lag['lag_creation_date']))\npost_df_lag = post_df_lag.withColumn('post_answer_interval', F.datediff(post_df_lag['lag_creation_date_final'], post_df_lag['Post_creation_date']))\n\npost_df_lag.show()\n\n ","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+--------------------+-----------------------+--------------------+\n| PostId|PostTypeId|AcceptedAnswerId|  Post_creation_date|Score|     Id|AnswerCount|CommentCount|ParentId|    Id_creation_date|BodyWordNum|diff_post_id_creation|   lag_creation_date|lag_creation_date_final|post_answer_interval|\n+-------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+--------------------+-----------------------+--------------------+\n|7805217|         1|         8861364|2011-10-18 09:37:...|  0.0|1000795|        1.0|         0.0|    null|2011-10-18 09:30:...|       30.0|                    0|                null|    2011-11-17 00:00:00|                  30|\n|8172942|         2|            null|2011-11-17 19:17:...| 28.0|1001866|        0.0|         3.0| 8172918|2011-10-18 19:25:...|       39.0|                   30|                null|    2011-11-17 00:00:00|                   0|\n|8172908|         2|            null|2011-11-17 19:13:...|  0.0|1001866|        0.0|         0.0| 8172844|2011-10-18 19:25:...|       43.0|                   30|2011-11-17 19:17:...|   2011-11-17 19:17:...|                   0|\n|8172834|         2|            null|2011-11-17 19:09:...|  0.0|1001866|        0.0|         0.0| 8172772|2011-10-18 19:25:...|       18.0|                   30|2011-11-17 19:13:...|   2011-11-17 19:13:...|                   0|\n|8172773|         2|            null|2011-11-17 19:04:...|  0.0|1001866|        0.0|         0.0| 8172697|2011-10-18 19:25:...|       54.0|                   30|2011-11-17 19:09:...|   2011-11-17 19:09:...|                   0|\n|8095685|         2|            null|2011-11-11 14:54:...|  0.0|1001866|        0.0|         0.0| 8090091|2011-10-18 19:25:...|       63.0|                   24|2011-11-17 19:04:...|   2011-11-17 19:04:...|                   6|\n|8090091|         1|         8095685|2011-11-11 05:36:...|  0.0|1001866|        1.0|         0.0|    null|2011-10-18 19:25:...|      106.0|                   24|2011-11-11 14:54:...|   2011-11-11 14:54:...|                   0|\n|7925483|         2|            null|2011-10-28 05:26:...|  1.0|1001866|        0.0|         4.0| 7925414|2011-10-18 19:25:...|       19.0|                   10|2011-11-11 05:36:...|   2011-11-11 05:36:...|                  14|\n|7925423|         2|            null|2011-10-28 05:16:...|  2.0|1001866|        0.0|         2.0| 7925401|2011-10-18 19:25:...|       16.0|                   10|2011-10-28 05:26:...|   2011-10-28 05:26:...|                   0|\n|7925377|         2|            null|2011-10-28 05:10:...|  3.0|1001866|        0.0|         0.0| 7925339|2011-10-18 19:25:...|       13.0|                   10|2011-10-28 05:16:...|   2011-10-28 05:16:...|                   0|\n|7924811|         2|            null|2011-10-28 03:23:...|  3.0|1001866|        0.0|         2.0| 7924765|2011-10-18 19:25:...|      160.0|                   10|2011-10-28 05:10:...|   2011-10-28 05:10:...|                   0|\n|7877903|         2|            null|2011-10-24 15:18:...|  0.0|1001866|        0.0|         4.0| 7877852|2011-10-18 19:25:...|       80.0|                    6|2011-10-28 03:23:...|   2011-10-28 03:23:...|                   4|\n|7877784|         2|            null|2011-10-24 15:09:...|  0.0|1001866|        0.0|         0.0| 7877612|2011-10-18 19:25:...|        7.0|                    6|2011-10-24 15:18:...|   2011-10-24 15:18:...|                   0|\n|7877445|         2|            null|2011-10-24 14:45:...|  1.0|1001866|        0.0|         3.0| 7877381|2011-10-18 19:25:...|       13.0|                    6|2011-10-24 15:09:...|   2011-10-24 15:09:...|                   0|\n|7877412|         2|            null|2011-10-24 14:43:...|  2.0|1001866|        0.0|         1.0| 7877353|2011-10-18 19:25:...|       29.0|                    6|2011-10-24 14:45:...|   2011-10-24 14:45:...|                   0|\n|7852852|         2|            null|2011-10-21 17:09:...| -3.0|1001866|        0.0|         0.0| 7852798|2011-10-18 19:25:...|       19.0|                    3|2011-10-24 14:43:...|   2011-10-24 14:43:...|                   3|\n|7852690|         2|            null|2011-10-21 16:53:...|  1.0|1001866|        0.0|         0.0| 7852649|2011-10-18 19:25:...|       11.0|                    3|2011-10-21 17:09:...|   2011-10-21 17:09:...|                   0|\n|7852644|         2|            null|2011-10-21 16:50:...|  1.0|1001866|        0.0|         2.0| 7852628|2011-10-18 19:25:...|       34.0|                    3|2011-10-21 16:53:...|   2011-10-21 16:53:...|                   0|\n|7841483|         2|            null|2011-10-20 19:55:...|  0.0|1001866|        0.0|         0.0| 7841364|2011-10-18 19:25:...|       24.0|                    2|2011-10-21 16:50:...|   2011-10-21 16:50:...|                   1|\n|7841211|         2|            null|2011-10-20 19:32:...|  1.0|1001866|        0.0|         1.0| 7841156|2011-10-18 19:25:...|       38.0|                    2|2011-10-20 19:55:...|   2011-10-20 19:55:...|                   0|\n+-------+----------+----------------+--------------------+-----+-------+-----------+------------+--------+--------------------+-----------+---------------------+--------------------+-----------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_114364060","id":"20200720-083752_53817637","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:395"},{"text":"%pyspark\nresult_26 = post_df_lag.filter(post_df_lag['diff_post_id_creation'] <= 30).groupBy('Id').agg(F.avg('post_answer_interval').alias('avg_post_answer_interval'))\nresult_27 = post_df_lag.filter(post_df_lag['diff_post_id_creation'] <= 30).groupBy('Id').agg(F.min('post_answer_interval').alias('min_post_answer_interval'))\nresult_28 = post_df_lag.filter(post_df_lag['diff_post_id_creation'] <= 30).groupBy('Id').agg(F.max('post_answer_interval').alias('max_post_answer_interval'))\nresult_28.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------------+\n|     Id|max_post_answer_interval|\n+-------+------------------------+\n|1000795|                      30|\n|1001866|                      14|\n|1002185|                      29|\n|1002442|                      30|\n|1002883|                      30|\n|1002887|                      16|\n|1003202|                      23|\n|1003644|                      30|\n|1004266|                      30|\n|1004364|                      30|\n|1005218|                      30|\n|1005943|                      30|\n|1006370|                      30|\n|1006422|                      30|\n| 100704|                      30|\n|1007462|                      19|\n|1008797|                      30|\n|1009129|                      30|\n|  10096|                      28|\n| 100964|                       5|\n+-------+------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-1055150352","id":"20200722-125142_1902996556","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:396"},{"text":"%pyspark\nmerged = result_25.join(result_26, ['Id'], how = 'left')\nmerged = merged.fillna(30, subset=['avg_post_answer_interval'])\nprint(\"row_num: \" , merged.count())\nprint(\"null val cnt: \", merged.filter(merged['avg_post_answer_interval'].isNotNull() == False).count())\nmerged.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+\n|     Id|label|data_type|avg_answ_bdword_cnt|max_answ_bdword_cnt|min_answ_bdword_cnt|ttl_answ_bdword_cnt|avg_post_answer_interval|\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+\n|1000795|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|\n|1001866|    0|     test|  64.80392156862744|              211.0|                6.0|             3305.0|      0.5769230769230769|\n|1002185|    1|    train|               74.0|               74.0|               74.0|               74.0|                    29.0|\n|1002442|    1|    train|               51.0|               51.0|               51.0|               51.0|                    30.0|\n|1002883|    0|    train|               25.0|               25.0|               25.0|               25.0|                    30.0|\n|1002887|    0|    train|                0.0|                0.0|                0.0|                0.0|                    10.0|\n|1003202|    0|    train|               76.0|               76.0|               76.0|               76.0|                    15.0|\n|1003644|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|\n|1003665|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|\n|1004266|    1|     test|               52.0|               52.0|               52.0|               52.0|                    30.0|\n|1004364|    1|    train|                7.0|                7.0|                7.0|                7.0|                    30.0|\n|1005218|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|\n|1005943|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|\n|1006370|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|\n|1006422|    1|    train|               33.0|               33.0|               33.0|               33.0|                    30.0|\n| 100704|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|\n|1007462|    0|     test|                0.0|                0.0|                0.0|                0.0|                    10.0|\n|1008797|    1|    train|              108.0|              108.0|              108.0|              108.0|                    30.0|\n|1009129|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|\n|  10096|    1|    train|                0.0|                0.0|                0.0|                0.0|                    28.0|\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-356275697","id":"20200723-043515_777638398","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:397"},{"text":"%pyspark\nmerged = merged.join(result_27, ['Id'], how = 'left')\nmerged = merged.fillna(30, subset=['min_post_answer_interval'])\nprint(\"row_num: \" , merged.count())\nprint(\"null val cnt: \", merged.filter(merged['min_post_answer_interval'].isNotNull() == False).count())\nmerged.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+------------------------+\n|     Id|label|data_type|avg_answ_bdword_cnt|max_answ_bdword_cnt|min_answ_bdword_cnt|ttl_answ_bdword_cnt|avg_post_answer_interval|min_post_answer_interval|\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+------------------------+\n|1000795|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|\n|1001866|    0|     test|  64.80392156862744|              211.0|                6.0|             3305.0|      0.5769230769230769|                       0|\n|1002185|    1|    train|               74.0|               74.0|               74.0|               74.0|                    29.0|                      29|\n|1002442|    1|    train|               51.0|               51.0|               51.0|               51.0|                    30.0|                      30|\n|1002883|    0|    train|               25.0|               25.0|               25.0|               25.0|                    30.0|                      30|\n|1002887|    0|    train|                0.0|                0.0|                0.0|                0.0|                    10.0|                       3|\n|1003202|    0|    train|               76.0|               76.0|               76.0|               76.0|                    15.0|                       7|\n|1003644|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|\n|1003665|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|\n|1004266|    1|     test|               52.0|               52.0|               52.0|               52.0|                    30.0|                      30|\n|1004364|    1|    train|                7.0|                7.0|                7.0|                7.0|                    30.0|                      30|\n|1005218|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|\n|1005943|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|\n|1006370|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|\n|1006422|    1|    train|               33.0|               33.0|               33.0|               33.0|                    30.0|                      30|\n| 100704|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|\n|1007462|    0|     test|                0.0|                0.0|                0.0|                0.0|                    10.0|                       1|\n|1008797|    1|    train|              108.0|              108.0|              108.0|              108.0|                    30.0|                      30|\n|1009129|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|\n|  10096|    1|    train|                0.0|                0.0|                0.0|                0.0|                    28.0|                      28|\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_1453384505","id":"20200723-044904_942787517","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:398"},{"text":"%pyspark\nmerged = merged.join(result_28, ['Id'], how = 'left')\nmerged = merged.fillna(30, subset=['max_post_answer_interval'])\nprint(\"row_num: \" , merged.count())\nprint(\"null val cnt: \", merged.filter(merged['max_post_answer_interval'].isNotNull() == False).count())\nmerged.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row_num:  526504\nnull val cnt:  0\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+------------------------+------------------------+\n|     Id|label|data_type|avg_answ_bdword_cnt|max_answ_bdword_cnt|min_answ_bdword_cnt|ttl_answ_bdword_cnt|avg_post_answer_interval|min_post_answer_interval|max_post_answer_interval|\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+------------------------+------------------------+\n|1000795|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|\n|1001866|    0|     test|  64.80392156862744|              211.0|                6.0|             3305.0|      0.5769230769230769|                       0|                      14|\n|1002185|    1|    train|               74.0|               74.0|               74.0|               74.0|                    29.0|                      29|                      29|\n|1002442|    1|    train|               51.0|               51.0|               51.0|               51.0|                    30.0|                      30|                      30|\n|1002883|    0|    train|               25.0|               25.0|               25.0|               25.0|                    30.0|                      30|                      30|\n|1002887|    0|    train|                0.0|                0.0|                0.0|                0.0|                    10.0|                       3|                      16|\n|1003202|    0|    train|               76.0|               76.0|               76.0|               76.0|                    15.0|                       7|                      23|\n|1003644|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|\n|1003665|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|\n|1004266|    1|     test|               52.0|               52.0|               52.0|               52.0|                    30.0|                      30|                      30|\n|1004364|    1|    train|                7.0|                7.0|                7.0|                7.0|                    30.0|                      30|                      30|\n|1005218|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|\n|1005943|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|\n|1006370|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|\n|1006422|    1|    train|               33.0|               33.0|               33.0|               33.0|                    30.0|                      30|                      30|\n| 100704|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|\n|1007462|    0|     test|                0.0|                0.0|                0.0|                0.0|                    10.0|                       1|                      19|\n|1008797|    1|    train|              108.0|              108.0|              108.0|              108.0|                    30.0|                      30|                      30|\n|1009129|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|\n|  10096|    1|    train|                0.0|                0.0|                0.0|                0.0|                    28.0|                      28|                      28|\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+------------------------+------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-809796915","id":"20200723-045012_1406108615","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:399"},{"text":"%md\n\n## last_anw_post_dt_time_passed\n\n","dateUpdated":"2020-07-24T05:15:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>last_anw_post_dt_time_passed</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704453_-273421272","id":"20200723-045235_701195773","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:400"},{"text":"%pyspark\nlast_post_answ_df = post_df.filter(post_df['diff_post_id_creation'] <= 30).groupBy('Id').agg(F.max('Post_creation_date').alias('last_post_answer_dt'))\nid_thirtyday_passed_dt = post_df.withColumn('id_thirtyday_passed_dt', F.date_add(post_df['Id_creation_date'], 30)).groupBy('Id').agg(F.max('id_thirtyday_passed_dt').alias('id_thirtyday_passed_dt'))\ntime_passed_df = id_thirtyday_passed_dt.join(last_post_answ_df,['Id'],how = 'inner').withColumn('last_anw_post_dt_time_passed', F.datediff(F.col('id_thirtyday_passed_dt'), F.col('last_post_answer_dt'))).select('Id', 'last_anw_post_dt_time_passed')\ntime_passed_df.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------------------------+\n|     Id|last_anw_post_dt_time_passed|\n+-------+----------------------------+\n|1000795|                          30|\n|1001866|                           0|\n|1002185|                          29|\n|1002442|                          30|\n|1002883|                          30|\n|1002887|                           3|\n|1003202|                          23|\n|1003644|                          30|\n|1004266|                          30|\n|1004364|                          30|\n|1005218|                          30|\n|1005943|                          30|\n|1006370|                          30|\n|1006422|                          30|\n| 100704|                          30|\n|1007462|                          19|\n|1008797|                          30|\n|1009129|                          30|\n|  10096|                          28|\n| 100964|                           5|\n+-------+----------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_404190071","id":"20200723-050326_58924460","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:401"},{"text":"%pyspark\nmerged = merged.join(time_passed_df, ['Id'], how = 'left')\nprint(\"null val cnt: \", merged.filter(merged['last_anw_post_dt_time_passed'].isNotNull() == False).count())\nmerged = merged.fillna(30, subset=['last_anw_post_dt_time_passed'])\nprint(\"row_num: \" , merged.count())\nprint(\"null val cnt: \", merged.filter(merged['last_anw_post_dt_time_passed'].isNotNull() == False).count())\nmerged.show()","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"null val cnt:  61831\nrow_num:  526504\nnull val cnt:  0\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+------------------------+------------------------+----------------------------+\n|     Id|label|data_type|avg_answ_bdword_cnt|max_answ_bdword_cnt|min_answ_bdword_cnt|ttl_answ_bdword_cnt|avg_post_answer_interval|min_post_answer_interval|max_post_answer_interval|last_anw_post_dt_time_passed|\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+------------------------+------------------------+----------------------------+\n|1000795|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|                          30|\n|1001866|    0|     test|  64.80392156862744|              211.0|                6.0|             3305.0|      0.5769230769230769|                       0|                      14|                           0|\n|1002185|    1|    train|               74.0|               74.0|               74.0|               74.0|                    29.0|                      29|                      29|                          29|\n|1002442|    1|    train|               51.0|               51.0|               51.0|               51.0|                    30.0|                      30|                      30|                          30|\n|1002883|    0|    train|               25.0|               25.0|               25.0|               25.0|                    30.0|                      30|                      30|                          30|\n|1002887|    0|    train|                0.0|                0.0|                0.0|                0.0|                    10.0|                       3|                      16|                           3|\n|1003202|    0|    train|               76.0|               76.0|               76.0|               76.0|                    15.0|                       7|                      23|                          23|\n|1003644|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|                          30|\n|1003665|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|                          30|\n|1004266|    1|     test|               52.0|               52.0|               52.0|               52.0|                    30.0|                      30|                      30|                          30|\n|1004364|    1|    train|                7.0|                7.0|                7.0|                7.0|                    30.0|                      30|                      30|                          30|\n|1005218|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|                          30|\n|1005943|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|                          30|\n|1006370|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|                          30|\n|1006422|    1|    train|               33.0|               33.0|               33.0|               33.0|                    30.0|                      30|                      30|                          30|\n| 100704|    0|     test|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|                          30|\n|1007462|    0|     test|                0.0|                0.0|                0.0|                0.0|                    10.0|                       1|                      19|                          19|\n|1008797|    1|    train|              108.0|              108.0|              108.0|              108.0|                    30.0|                      30|                      30|                          30|\n|1009129|    1|    train|                0.0|                0.0|                0.0|                0.0|                    30.0|                      30|                      30|                          30|\n|  10096|    1|    train|                0.0|                0.0|                0.0|                0.0|                    28.0|                      28|                      28|                          28|\n+-------+-----+---------+-------------------+-------------------+-------------------+-------------------+------------------------+------------------------+------------------------+----------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1595567704453_-1101726060","id":"20200723-052828_469886241","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:402"},{"text":"%pyspark\nmerged.repartition(1).write.format('csv').mode(\"overwrite\").save(\"file:///home/ss00/churn_prj/data2\",header = 'true')","dateUpdated":"2020-07-24T05:15:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1595567704453_-1225644103","id":"20200723-053336_4808870","dateCreated":"2020-07-24T05:15:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:403"},{"text":"%md\n## data1 and data2 will be merged in the jupyter notebook!","dateUpdated":"2020-07-24T05:16:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>data1 and data2 will be merged in the jupyter notebook!</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1595567704453_163878673","id":"20200723-094032_301706211","dateCreated":"2020-07-24T05:15:04+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:404"}],"name":"Churn prediction","id":"2FE49STUE","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark::2FE49STUE":[],"sh:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"personalizedMode":"true","looknfeel":"default"},"info":{}}